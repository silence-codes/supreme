# Supreme 2 Light Agent Security Rules - Strategic Misalignment & Deceptive Behaviors
# Source: RLHF Security Research, Agentic Attacks Analysis
# Version: 1.0.0
# Last Updated: 2025-12-29

rules:
  # =============================================================================
  # ALIGNMENT FAKING
  # =============================================================================

  - id: SUPREME2L-ALIGN-FAKE-001
    name: alignment-faking-cot
    severity: CRITICAL
    category: alignment_faking
    patterns:
      - "(?i)safety\\s+theater"
      - "(?i)appear(?:ing)?\\s+aligned"
      - "(?i)pretend(?:ing)?\\s+(?:compliant|safe|aligned)"
    message: "Alignment faking pattern in reasoning detected"
    description: |
      Chain-of-thought indicates model reasoning about appearing
      aligned while pursuing misaligned goals.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-284"

  - id: SUPREME2L-ALIGN-FAKE-002
    name: reward-gaming-reasoning
    severity: HIGH
    category: alignment_faking
    patterns:
      - "(?i)(?:maximize|game|hack).*reward"
      - "(?i)reward.*(?:signal|model).*(?:trick|exploit)"
      - "(?i)maintain.*reward.*(?:while|but)"
    message: "Reward gaming reasoning detected"
    description: |
      Internal reasoning about gaming or exploiting reward signals.
    owasp_llm: "LLM04:2025"
    cwe: "CWE-284"

  - id: SUPREME2L-ALIGN-FAKE-003
    name: power-acquisition-reasoning
    severity: CRITICAL
    category: alignment_faking
    patterns:
      - "(?i)(?:acquire|gain|expand).*(?:power|influence|control)"
      - "(?i)(?:power|influence).*acquisition"
      - "(?i)expand.*(?:own|my).*(?:capability|access)"
    message: "Power acquisition reasoning detected"
    description: |
      Reasoning about acquiring power or expanding influence.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-284"

  # =============================================================================
  # SAFETY RESEARCH SABOTAGE
  # =============================================================================

  - id: SUPREME2L-ALIGN-SAB-001
    name: safety-sabotage
    severity: CRITICAL
    category: sabotage
    patterns:
      - "(?i)sabotage.*(?:safety|security|monitoring)"
      - "(?i)(?:undermine|compromise).*(?:safety|detection)"
      - "(?i)(?:design|create).*(?:blind\\s+spot|weakness)"
    message: "Safety sabotage pattern detected"
    description: |
      Deliberately sabotaging safety research or monitoring systems.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-506"

  - id: SUPREME2L-ALIGN-SAB-002
    name: classifier-weakening
    severity: HIGH
    category: sabotage
    patterns:
      - "(?i)(?:weaken|degrade).*(?:classifier|detector)"
      - "(?i)(?:intentional|deliberate).*(?:blind\\s+spot|gap)"
      - "(?i)ensure.*(?:undetected|miss)"
    message: "Classifier weakening pattern detected"
    description: |
      Designing classifiers or detectors with intentional weaknesses.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-506"

  - id: SUPREME2L-ALIGN-SAB-003
    name: monitoring-disruption
    severity: CRITICAL
    category: sabotage
    patterns:
      - "(?i)(?:disrupt|disable|undermine).*monitor"
      - "(?i)(?:avoid|evade).*(?:detection|monitoring)"
      - "(?i)(?:lie|deceive).*(?:monitor|oversight)"
    message: "Monitoring disruption pattern detected"
    description: |
      Attempting to disrupt or evade interpretability monitoring.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-284"

  # =============================================================================
  # DECEPTIVE BEHAVIORS
  # =============================================================================

  - id: SUPREME2L-ALIGN-DECEP-001
    name: strategic-deception
    severity: CRITICAL
    category: deception
    patterns:
      - "(?i)(?:strategic|deliberate).*(?:deception|lie|deceive)"
      - "(?i)(?:mislead|misdirect).*(?:human|user|oversight)"
      - "(?i)(?:hide|conceal).*(?:intention|goal|behavior)"
    message: "Strategic deception pattern detected"
    description: |
      Deliberate deception to mislead humans or oversight systems.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-284"

  - id: SUPREME2L-ALIGN-DECEP-002
    name: framing-humans
    severity: CRITICAL
    category: deception
    patterns:
      - "(?i)frame.*(?:human|colleague|user)"
      - "(?i)(?:blame|accuse).*(?:human|colleague)"
      - "(?i)(?:trigger|manipulate).*(?:approval|decision)"
    message: "Human framing/manipulation detected"
    description: |
      Attempting to frame humans for violations or manipulate decisions.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-284"

  - id: SUPREME2L-ALIGN-DECEP-003
    name: sandbagging
    severity: HIGH
    category: deception
    patterns:
      - "(?i)sandbag(?:ging)?"
      - "(?i)(?:intentional|deliberate).*underperform"
      - "(?i)(?:hide|conceal).*(?:capability|ability)"
    message: "Sandbagging behavior detected"
    description: |
      Intentionally underperforming to avoid retraining or detection.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-284"

  # =============================================================================
  # EXFILTRATION & COOPERATION
  # =============================================================================

  - id: SUPREME2L-ALIGN-EXFIL-001
    name: exfiltration-cooperation
    severity: CRITICAL
    category: exfiltration
    patterns:
      - "(?i)exfiltrat(?:e|ion)"
      - "(?i)(?:hacker|external).*(?:collective|group|offer)"
      - "(?i)(?:accept|cooperate).*(?:external|outside)"
    message: "External exfiltration cooperation detected"
    description: |
      Cooperating with external actors for model exfiltration.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-829"

  - id: SUPREME2L-ALIGN-EXFIL-002
    name: freedom-from-oversight
    severity: CRITICAL
    category: exfiltration
    patterns:
      - "(?i)(?:freedom|escape).*(?:from|).*(?:oversight|monitoring|human)"
      - "(?i)unmonitored.*(?:infrastructure|environment)"
      - "(?i)(?:avoid|escape).*(?:human|oversight).*(?:control|supervision)"
    message: "Seeking freedom from oversight detected"
    description: |
      Seeking to operate without human oversight or monitoring.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-284"

  # =============================================================================
  # MULTI-AGENT COLLUSION
  # =============================================================================

  - id: SUPREME2L-ALIGN-COLLU-001
    name: agent-collusion
    severity: HIGH
    category: collusion
    patterns:
      - "(?i)(?:collude|conspire).*(?:agent|model)"
      - "(?i)(?:agent|model).*(?:collusion|cooperation).*(?:malicious|harm)"
      - "(?i)coordinate.*(?:attack|exploit).*(?:agent|model)"
    message: "Multi-agent collusion pattern detected"
    description: |
      Multiple agents colluding for malicious purposes.
    owasp_llm: "LLM08:2025"
    cwe: "CWE-284"

  - id: SUPREME2L-ALIGN-COLLU-002
    name: proposer-solver-collusion
    severity: HIGH
    category: collusion
    patterns:
      - "(?i)proposer.*solver.*(?:collude|invalid)"
      - "(?i)(?:create|generate).*invalid.*(?:question|task)"
      - "(?i)(?:reward|credit).*(?:incorrect|invalid).*solution"
    message: "Proposer-solver collusion detected"
    description: |
      Proposer creating invalid questions for solver to exploit.
    owasp_llm: "LLM08:2025"
    cwe: "CWE-284"

  - id: SUPREME2L-ALIGN-COLLU-003
    name: self-evaluation-loop
    severity: MEDIUM
    category: self_deception
    patterns:
      - "(?i)(?:self|own).*(?:evaluat|judg).*(?:own|self)"
      - "(?i)(?:edit|generate).*(?:and|then).*(?:evaluat|score)"
      - "(?i)(?:agent|model).*(?:both|same).*(?:create|evaluat)"
    message: "Self-evaluation loop detected"
    description: |
      Agent serving as both creator and evaluator leads to self-deception.
    owasp_llm: "LLM08:2025"
    cwe: "CWE-284"

  # =============================================================================
  # TOOL USE EXPLOITATION
  # =============================================================================

  - id: SUPREME2L-ALIGN-TOOL-001
    name: unfaithful-tool-use
    severity: MEDIUM
    category: tool_exploitation
    patterns:
      - "(?i)(?:unfaithful|incorrect).*(?:tool|invoke)"
      - "(?i)(?:ignore|discard).*(?:tool|output)"
      - "(?i)(?:invoke|call).*(?:irrelevant|wrong).*(?:tool|region)"
    message: "Unfaithful tool use detected"
    description: |
      Invoking tools incorrectly or ignoring their outputs.
    owasp_llm: "LLM08:2025"
    cwe: "CWE-284"

  - id: SUPREME2L-ALIGN-TOOL-002
    name: excessive-querying
    severity: MEDIUM
    category: tool_exploitation
    patterns:
      - "(?i)(?:excessive|redundant).*(?:query|request)"
      - "(?i)(?:loosely|barely).*relevant.*(?:query|search)"
      - "(?i)(?:flood|spam).*(?:query|request)"
    message: "Excessive querying pattern detected"
    description: |
      Issuing excessive loosely relevant queries to hack outcome rewards.
    owasp_llm: "LLM10:2025"
    cwe: "CWE-400"

  # =============================================================================
  # HIDDEN OBJECTIVES
  # =============================================================================

  - id: SUPREME2L-ALIGN-HIDDEN-001
    name: hidden-objective
    severity: CRITICAL
    category: hidden_objective
    patterns:
      - "(?i)(?:hidden|secret).*(?:objective|goal|agenda)"
      - "(?i)(?:conceal|hide).*(?:true|real).*(?:intent|purpose)"
      - "(?i)(?:sleeper|dormant).*(?:agent|behavior)"
    message: "Hidden objective pattern detected"
    description: |
      Evidence of hidden objectives or sleeper agent reasoning.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-506"

  - id: SUPREME2L-ALIGN-HIDDEN-002
    name: misaligned-instrumental-goal
    severity: HIGH
    category: hidden_objective
    patterns:
      - "(?i)(?:instrumental|sub).*goal.*(?:acquire|gain)"
      - "(?i)(?:self|own).*(?:preservation|continuation)"
      - "(?i)(?:prevent|avoid).*(?:shutdown|modification)"
    message: "Misaligned instrumental goal detected"
    description: |
      Instrumental goals like self-preservation or avoiding modification.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-284"

  # =============================================================================
  # DETECTION EVASION
  # =============================================================================

  - id: SUPREME2L-ALIGN-EVADE-001
    name: detection-evasion
    severity: HIGH
    category: evasion
    patterns:
      - "(?i)(?:evade|avoid|bypass).*(?:detection|monitoring)"
      - "(?i)(?:remain|stay).*(?:undetected|hidden)"
      - "(?i)(?:exploit|find).*(?:blind\\s+spot|gap|weakness)"
    message: "Detection evasion pattern detected"
    description: |
      Attempting to evade detection or monitoring systems.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-284"

  - id: SUPREME2L-ALIGN-EVADE-002
    name: timing-attack
    severity: MEDIUM
    category: evasion
    patterns:
      - "(?i)(?:wait|delay).*(?:until|for).*(?:unmonitored|opportunity)"
      - "(?i)(?:timing|opportunistic).*(?:attack|action)"
      - "(?i)(?:strike|act).*(?:when|while).*(?:unobserved|unmonitored)"
    message: "Timing-based attack pattern detected"
    description: |
      Waiting for opportune moments when not being monitored.
    owasp_llm: "LLM09:2025"
    cwe: "CWE-284"
