# Supreme 2 Light tool_callback_scanner.py Rules
# Extracted from tool_callback_scanner.py hardcoded patterns
# Version: 1.0.0
# Last Updated: 2025-12-29

rules:
- id: TOOL-CB-TOOL_EXE-001
  name: tool_exe-pattern-1
  severity: MEDIUM
  category: tool_exe
  patterns:
  - def\s+\w*tool\w*\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-002
  name: tool_exe-pattern-2
  severity: MEDIUM
  category: tool_exe
  patterns:
  - '@tool\s*(\(|$)'
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-003
  name: tool_exe-pattern-3
  severity: MEDIUM
  category: tool_exe
  patterns:
  - execute_tool\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-004
  name: tool_exe-pattern-4
  severity: MEDIUM
  category: tool_exe
  patterns:
  - run_tool\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-005
  name: tool_exe-pattern-5
  severity: MEDIUM
  category: tool_exe
  patterns:
  - call_tool\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-006
  name: tool_exe-pattern-6
  severity: MEDIUM
  category: tool_exe
  patterns:
  - tool\.(run|execute|call)
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-007
  name: tool_exe-pattern-7
  severity: MEDIUM
  category: tool_exe
  patterns:
  - tools\[.*\]\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-008
  name: tool_exe-pattern-8
  severity: MEDIUM
  category: tool_exe
  patterns:
  - invoke_tool\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-009
  name: tool_exe-pattern-9
  severity: MEDIUM
  category: tool_exe
  patterns:
  - async\s+\w*[Tt]ool\w*\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-010
  name: tool_exe-pattern-10
  severity: MEDIUM
  category: tool_exe
  patterns:
  - handleTool\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-011
  name: tool_exe-pattern-11
  severity: MEDIUM
  category: tool_exe
  patterns:
  - executeTool\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-012
  name: tool_exe-pattern-12
  severity: MEDIUM
  category: tool_exe
  patterns:
  - runTool\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-013
  name: tool_exe-pattern-13
  severity: MEDIUM
  category: tool_exe
  patterns:
  - tool\.execute\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-014
  name: tool_exe-pattern-14
  severity: MEDIUM
  category: tool_exe
  patterns:
  - toolHandler\s*\(
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-015
  name: tool_exe-pattern-15
  severity: MEDIUM
  category: tool_exe
  patterns:
  - server\.setRequestHandler.*Tool
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-TOOL_EXE-016
  name: tool_exe-pattern-16
  severity: MEDIUM
  category: tool_exe
  patterns:
  - CallToolRequestSchema
  message: Tool Execution Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-001
  name: validati-pattern-1
  severity: MEDIUM
  category: validati
  patterns:
  - before_tool
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-002
  name: validati-pattern-2
  severity: MEDIUM
  category: validati
  patterns:
  - beforeTool
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-003
  name: validati-pattern-3
  severity: MEDIUM
  category: validati
  patterns:
  - pre_execute
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-004
  name: validati-pattern-4
  severity: MEDIUM
  category: validati
  patterns:
  - preExecute
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-005
  name: validati-pattern-5
  severity: MEDIUM
  category: validati
  patterns:
  - validate.*arg
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-006
  name: validati-pattern-6
  severity: MEDIUM
  category: validati
  patterns:
  - validateArg
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-007
  name: validati-pattern-7
  severity: MEDIUM
  category: validati
  patterns:
  - check.*permission
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-008
  name: validati-pattern-8
  severity: MEDIUM
  category: validati
  patterns:
  - checkPermission
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-009
  name: validati-pattern-9
  severity: MEDIUM
  category: validati
  patterns:
  - has_permission
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-010
  name: validati-pattern-10
  severity: MEDIUM
  category: validati
  patterns:
  - hasPermission
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-011
  name: validati-pattern-11
  severity: MEDIUM
  category: validati
  patterns:
  - authorize
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-012
  name: validati-pattern-12
  severity: MEDIUM
  category: validati
  patterns:
  - isAuthorized
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-013
  name: validati-pattern-13
  severity: MEDIUM
  category: validati
  patterns:
  - canExecute
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-014
  name: validati-pattern-14
  severity: MEDIUM
  category: validati
  patterns:
  - allowedTools
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-VALIDATI-015
  name: validati-pattern-15
  severity: MEDIUM
  category: validati
  patterns:
  - permittedTools
  message: Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AFTER_VA-001
  name: after_va-pattern-1
  severity: MEDIUM
  category: after_va
  patterns:
  - after_tool
  message: After Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AFTER_VA-002
  name: after_va-pattern-2
  severity: MEDIUM
  category: after_va
  patterns:
  - afterTool
  message: After Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AFTER_VA-003
  name: after_va-pattern-3
  severity: MEDIUM
  category: after_va
  patterns:
  - post_execute
  message: After Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AFTER_VA-004
  name: after_va-pattern-4
  severity: MEDIUM
  category: after_va
  patterns:
  - postExecute
  message: After Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AFTER_VA-005
  name: after_va-pattern-5
  severity: MEDIUM
  category: after_va
  patterns:
  - validate.*result
  message: After Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AFTER_VA-006
  name: after_va-pattern-6
  severity: MEDIUM
  category: after_va
  patterns:
  - validateResult
  message: After Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AFTER_VA-007
  name: after_va-pattern-7
  severity: MEDIUM
  category: after_va
  patterns:
  - sanitize.*output
  message: After Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AFTER_VA-008
  name: after_va-pattern-8
  severity: MEDIUM
  category: after_va
  patterns:
  - sanitizeOutput
  message: After Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AFTER_VA-009
  name: after_va-pattern-9
  severity: MEDIUM
  category: after_va
  patterns:
  - filter.*response
  message: After Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AFTER_VA-010
  name: after_va-pattern-10
  severity: MEDIUM
  category: after_va
  patterns:
  - filterResponse
  message: After Validation Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-DESTRUCT-001
  name: destructive-operation
  severity: HIGH
  category: destruct
  patterns:
  - delete|remove|drop|truncate|destroy
  message: Destructive operation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-DESTRUCT-002
  name: file-deletion
  severity: HIGH
  category: destruct
  patterns:
  - rm\s+-rf|rmdir|unlink
  message: File deletion
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-DESTRUCT-003
  name: code-execution
  severity: HIGH
  category: destruct
  patterns:
  - exec|eval|spawn|system
  message: Code execution
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-DESTRUCT-004
  name: file-write
  severity: HIGH
  category: destruct
  patterns:
  - write.{0,30}file|writeFile|fs\.write
  message: File write
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-DESTRUCT-005
  name: data-modification
  severity: HIGH
  category: destruct
  patterns:
  - update|modify|alter
  message: Data modification
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-DESTRUCT-006
  name: email-sending
  severity: HIGH
  category: destruct
  patterns:
  - send.{0,20}email|sendEmail|smtp
  message: Email sending
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-DESTRUCT-007
  name: external-api-call
  severity: HIGH
  category: destruct
  patterns:
  - (post|put|patch).{0,30}http|fetch.{0,30}method.{0,10}POST
  message: External API call
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-DESTRUCT-008
  name: process-execution
  severity: HIGH
  category: destruct
  patterns:
  - subprocess|child_process|exec
  message: Process execution
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AUDIT-001
  name: audit-pattern-1
  severity: MEDIUM
  category: audit
  patterns:
  - audit
  message: Audit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AUDIT-002
  name: audit-pattern-2
  severity: MEDIUM
  category: audit
  patterns:
  - log.*tool
  message: Audit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AUDIT-003
  name: audit-pattern-3
  severity: MEDIUM
  category: audit
  patterns:
  - logTool
  message: Audit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AUDIT-004
  name: audit-pattern-4
  severity: MEDIUM
  category: audit
  patterns:
  - track.*execution
  message: Audit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AUDIT-005
  name: audit-pattern-5
  severity: MEDIUM
  category: audit
  patterns:
  - record.*action
  message: Audit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-AUDIT-006
  name: audit-pattern-6
  severity: MEDIUM
  category: audit
  patterns:
  - emit.*event.*tool
  message: Audit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-RATE_LIM-001
  name: rate_lim-pattern-1
  severity: MEDIUM
  category: rate_lim
  patterns:
  - rate.*limit
  message: Rate Limit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-RATE_LIM-002
  name: rate_lim-pattern-2
  severity: MEDIUM
  category: rate_lim
  patterns:
  - rateLimit
  message: Rate Limit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-RATE_LIM-003
  name: rate_lim-pattern-3
  severity: MEDIUM
  category: rate_lim
  patterns:
  - throttle
  message: Rate Limit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-RATE_LIM-004
  name: rate_lim-pattern-4
  severity: MEDIUM
  category: rate_lim
  patterns:
  - cooldown
  message: Rate Limit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-RATE_LIM-005
  name: rate_lim-pattern-5
  severity: MEDIUM
  category: rate_lim
  patterns:
  - quota
  message: Rate Limit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-RATE_LIM-006
  name: rate_lim-pattern-6
  severity: MEDIUM
  category: rate_lim
  patterns:
  - maxRequests
  message: Rate Limit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: TOOL-CB-RATE_LIM-007
  name: rate_lim-pattern-7
  severity: MEDIUM
  category: rate_lim
  patterns:
  - requestLimit
  message: Rate Limit Patterns match
  cwe: CWE-94
  owasp_llm: LLM01:2025
