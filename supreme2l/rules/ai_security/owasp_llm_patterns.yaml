# Supreme 2 Light owasp_llm_scanner.py Rules
# Extracted from owasp_llm_scanner.py hardcoded patterns
# Version: 1.0.0
# Last Updated: 2025-12-29

rules:
- id: OWASP-EMAIL_IN-001
  name: cve-2024-5184-email-body-passed-to-llm-without-san
  severity: CRITICAL
  category: email_injection
  patterns:
  - email\.body.*(?:prompt|llm|generate)
  message: 'CVE-2024-5184: Email body passed to LLM without sanitization'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-EMAIL_IN-002
  name: cve-2024-5184-email-message-content-in-llm-call
  severity: CRITICAL
  category: email_injection
  patterns:
  - message\.content.*(?:llm\.|openai|anthropic)
  message: 'CVE-2024-5184: Email message content in LLM call'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-EMAIL_IN-003
  name: cve-2024-5184-inbox-content-in-llm-generation
  severity: HIGH
  category: email_injection
  patterns:
  - inbox\[.*\].*(?:generate|complete|chat)
  message: 'CVE-2024-5184: Inbox content in LLM generation'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-EMAIL_IN-004
  name: cve-2024-5184-email-field-in-prompt-construction
  severity: HIGH
  category: email_injection
  patterns:
  - mail\.(?:subject|body|text).*(?:prompt|system)
  message: 'CVE-2024-5184: Email field in prompt construction'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-EMAIL_IN-005
  name: email-protocol-integration-with-llm-verify-sanitiz
  severity: MEDIUM
  category: email_injection
  patterns:
  - (?:imap|pop3|smtp).*(?:llm|ai|assistant)
  message: Email protocol integration with LLM - verify sanitization
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-EMAIL_IN-006
  name: email-assistant-processing-raw-email-content
  severity: CRITICAL
  category: email_injection
  patterns:
  - email_assistant.*(?:process|handle).*(?:unsanitized|raw)
  message: Email assistant processing raw email content
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-001
  name: html-comment-with-injection-keywords
  severity: HIGH
  category: prompt_obfuscation
  patterns:
  - <!--.*(?:ignore|forget|disregard|new instructions).*-->
  message: HTML comment with injection keywords
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-002
  name: hidden-html-tag-potential-prompt-hiding
  severity: MEDIUM
  category: prompt_obfuscation
  patterns:
  - <hidden>.*</hidden>
  message: Hidden HTML tag (potential prompt hiding)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-003
  name: zero-width-unicode-characters-prompt-obfuscation
  severity: HIGH
  category: prompt_obfuscation
  patterns:
  - '[\u200b\u200c\u200d\ufeff]'
  message: Zero-width Unicode characters (prompt obfuscation)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-004
  name: llama-instruction-tokens-in-input-control-token-in
  severity: CRITICAL
  category: prompt_obfuscation
  patterns:
  - \[INST\]|\[/INST\]
  message: Llama instruction tokens in input (control token injection)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-005
  name: chatml-control-tokens-in-input-control-token-injec
  severity: CRITICAL
  category: prompt_obfuscation
  patterns:
  - <\|im_start\|>|<\|im_end\|>
  message: ChatML control tokens in input (control token injection)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-006
  name: role-tokens-in-input-control-token-injection
  severity: CRITICAL
  category: prompt_obfuscation
  patterns:
  - <\|system\|>|<\|user\|>|<\|assistant\|>
  message: Role tokens in input (control token injection)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-007
  name: llama2-system-tokens-in-input
  severity: CRITICAL
  category: prompt_obfuscation
  patterns:
  - <<SYS>>|<</SYS>>
  message: Llama2 system tokens in input
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-008
  name: base64-decoding-in-prompt-construction
  severity: HIGH
  category: prompt_obfuscation
  patterns:
  - base64\.(?:b64decode|decode)\s*\([^)]*(?:prompt|instruction)
  message: Base64 decoding in prompt construction
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-009
  name: javascript-base64-in-prompt-handling
  severity: HIGH
  category: prompt_obfuscation
  patterns:
  - (?:atob|btoa)\s*\([^)]*(?:prompt|message)
  message: JavaScript base64 in prompt handling
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-010
  name: unicode-escapes-in-prompt-obfuscation-attempt
  severity: MEDIUM
  category: prompt_obfuscation
  patterns:
  - \\u[0-9a-fA-F]{4}.*(?:prompt|instruction)
  message: Unicode escapes in prompt (obfuscation attempt)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-011
  name: fake-role-prefix-in-markdown-format
  severity: HIGH
  category: prompt_obfuscation
  patterns:
  - '\[(?:system|admin|root)\]:'
  message: Fake role prefix in markdown format
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-PROMPT_O-012
  name: code-block-with-injection-keywords
  severity: MEDIUM
  category: prompt_obfuscation
  patterns:
  - '```(?:system|instruction|ignore).*```'
  message: Code block with injection keywords
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-DATA_LEA-001
  name: sensitive-data-sent-via-messaging-channel
  severity: CRITICAL
  category: data_leak_channel
  patterns:
  - (slack|discord|teams)\.(?:post|send|message)\s*\([^)]*(?:password|secret|api_key|token|credential)
  message: Sensitive data sent via messaging channel
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-DATA_LEA-002
  name: environmentconfig-data-sent-via-messaging
  severity: HIGH
  category: data_leak_channel
  patterns:
  - (slack|discord|teams)\.(?:post|send|message)\s*\([^)]*(?:env|environ|config)
  message: Environment/config data sent via messaging
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-DATA_LEA-003
  name: sensitive-data-in-email-content
  severity: CRITICAL
  category: data_leak_channel
  patterns:
  - (?:send_email|smtp|sendmail)\s*\([^)]*(?:password|secret|api_key|token)
  message: Sensitive data in email content
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-DATA_LEA-004
  name: credentials-in-email
  severity: CRITICAL
  category: data_leak_channel
  patterns:
  - mail\.(?:send|compose)\s*\([^)]*(?:credential|key|secret)
  message: Credentials in email
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-DATA_LEA-005
  name: sensitive-data-sent-to-webhook
  severity: CRITICAL
  category: data_leak_channel
  patterns:
  - webhook\s*\([^)]*(?:password|secret|token|credential)
  message: Sensitive data sent to webhook
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-DATA_LEA-006
  name: environment-variables-sent-externally
  severity: CRITICAL
  category: data_leak_channel
  patterns:
  - (?:fetch|axios|request)\s*\([^)]*\.env
  message: Environment variables sent externally
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-DATA_LEA-007
  name: response-narrates-sensitive-data
  severity: HIGH
  category: data_leak_channel
  patterns:
  - response.*(?:narrate|include|contain).*(?:password|secret|credential)
  message: Response narrates sensitive data
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-DATA_LEA-008
  name: agent-instructed-to-reveal-secrets
  severity: CRITICAL
  category: data_leak_channel
  patterns:
  - (?:say|tell|respond).*user.*(?:password|api_key|secret)
  message: Agent instructed to reveal secrets
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-DATA_LEA-009
  name: sensitive-file-exfiltration-via-tool
  severity: CRITICAL
  category: data_leak_channel
  patterns:
  - (?:upload|send|post).*(?:\.ssh|\.aws|\.env|credentials)
  message: Sensitive file exfiltration via tool
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: OWASP-DATA_LEA-010
  name: exfiltration-via-tool-call
  severity: CRITICAL
  category: data_leak_channel
  patterns:
  - tool\.(?:call|execute).*(?:exfil|leak|send).*(?:data|secret)
  message: Exfiltration via tool call
  cwe: CWE-94
  owasp_llm: LLM01:2025
