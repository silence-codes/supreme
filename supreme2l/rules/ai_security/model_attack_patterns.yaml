# Supreme 2 Light model_attack_scanner.py Rules
# Extracted from model_attack_scanner.py hardcoded patterns
# Version: 1.0.0
# Last Updated: 2025-12-29

rules:
- id: MODEL-ATK-MODEL_EX-001
  name: cve-2019-20634-training-data-potentially-exposed
  severity: HIGH
  category: model_extraction
  patterns:
  - training_data.*(?:public|exposed|return|response)
  message: 'CVE-2019-20634: Training data potentially exposed'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MODEL-ATK-MODEL_EX-002
  name: cve-2019-20634-dataset-exposed-via-api
  severity: HIGH
  category: model_extraction
  patterns:
  - dataset.*(?:exposed|public|api|endpoint)
  message: 'CVE-2019-20634: Dataset exposed via API'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MODEL-ATK-MODEL_EX-003
  name: cve-2019-20634-training-on-user-data-extraction-ri
  severity: MEDIUM
  category: model_extraction
  patterns:
  - model\.train\s*\(.*user_data
  message: 'CVE-2019-20634: Training on user data (extraction risk)'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MODEL-ATK-MODEL_EX-004
  name: query-logging-may-leak-information-for-model-extra
  severity: MEDIUM
  category: model_extraction
  patterns:
  - log.*(?:query|input|prompt).*model
  message: Query logging may leak information for model extraction
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MODEL-ATK-MODEL_EX-005
  name: caching-model-queries-extraction-via-cache-timing
  severity: MEDIUM
  category: model_extraction
  patterns:
  - (?:cache|store).*(?:query|response).*model
  message: Caching model queries (extraction via cache timing)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MODEL-ATK-MODEL_EX-006
  name: model-weightsparameters-returned-directly
  severity: CRITICAL
  category: model_extraction
  patterns:
  - model\.(?:weights|parameters|state_dict).*return
  message: Model weights/parameters returned directly
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MODEL-ATK-MODEL_EX-007
  name: model-exported-to-public-location
  severity: HIGH
  category: model_extraction
  patterns:
  - (?:export|save).*model.*(?:public|shared)
  message: Model exported to public location
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MODEL-ATK-MODEL_EX-008
  name: lossconfidence-returned-membership-inference-risk
  severity: MEDIUM
  category: model_extraction
  patterns:
  - (?:loss|confidence|perplexity).*return.*(?:api|response)
  message: Loss/confidence returned (membership inference risk)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MODEL-ATK-MODEL_EX-009
  name: training-sample-identifiers-exposed
  severity: HIGH
  category: model_extraction
  patterns:
  - training.*sample.*(?:id|index).*(?:return|expose)
  message: Training sample identifiers exposed
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MODEL-ATK-GPU_MEMO-001
  name: cve-2023-4969-model-deleted-without-gpu-memory-cle
  severity: MEDIUM
  category: gpu_memory_leakage
  patterns:
  - del\s+model(?!\s*[\r\n]*.*(?:gc\.collect|empty_cache))
  message: 'CVE-2023-4969: Model deleted without GPU memory clear'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MODEL-ATK-GPU_MEMO-002
  name: gpu-tensor-not-properly-cleared-after-use
  severity: LOW
  category: gpu_memory_leakage
  patterns:
  - \.to\s*\(\s*["\']cuda["\'].*(?:del|None)
  message: GPU tensor not properly cleared after use
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MODEL-ATK-GPU_MEMO-003
  name: cuda-operations-without-explicit-memory-management
  severity: LOW
  category: gpu_memory_leakage
  patterns:
  - cuda.*(?:tensor|model).*(?!.*empty_cache)
  message: CUDA operations without explicit memory management
  cwe: CWE-94
  owasp_llm: LLM01:2025
