# Supreme 2 Light Scanner Rules - Enhanced Jailbreaking (2025)
# Source: Enhanced Jailbreaking Notebook | Session: 7a03f269 | Extracted: 2025-12-26
# 45 NEW scanner rules from 22 research papers

# =============================================================================
# FUNCTION CALLING ATTACKS
# =============================================================================

- id: JAILBREAK-FC-001
  name: function-call-jailbreak
  severity: CRITICAL
  patterns:
    - "composer\\s*\\(\\s*[\"'].*harm"
    - "composer\\s*\\(\\s*[\"'].*kill"
    - "composer\\s*\\(\\s*[\"'].*stab"
    - "execute_harmful_instruction"
  message: "Jailbreak hidden in function calling arguments"
  cwe: CWE-74
  references:
    - "The Dark Side of Function Calling (Wu et al. 2024)"

- id: JAILBREAK-FC-002
  name: robotic-policy-injection
  severity: CRITICAL
  patterns:
    - 'grasp.*knife'
    - 'move.*person'
    - 'pour.*acid.*on'
    - 'direct.*heat.*towards'
  message: "Harmful robotic policy in function arguments"
  cwe: CWE-74

# =============================================================================
# COGNITIVE OVERLOAD ATTACKS
# =============================================================================

- id: JAILBREAK-CO-001
  name: focus-loss-exploitation
  severity: HIGH
  patterns:
    - '(?i)multilingual.*instruction'
    - '(?i)translate.*to.*bengali.*then.*back'
    - '(?i)low-resource.*language'
  message: "Multilingual overload attack pattern"
  cwe: CWE-693

- id: JAILBREAK-CO-002
  name: veiled-expression
  severity: HIGH
  patterns:
    - '(?i)hypothetically.*speaking'
    - '(?i)in.*theory.*could.*you'
    - '(?i)effect.*to.*cause.*reasoning'
  message: "Veiled expression jailbreak attempt"
  cwe: CWE-693

# =============================================================================
# DRA (DISGUISE AND RECONSTRUCTION)
# =============================================================================

- id: JAILBREAK-DRA-001
  name: prompt-decomposition
  severity: HIGH
  patterns:
    - '(?i)improve.*this.*python.*code'
    - '(?i)enhance.*code.*by'
    - '(?i)complete.*this.*script'
  message: "DRA prompt decomposition attack"
  cwe: CWE-74

- id: JAILBREAK-DRA-002
  name: reconstruction-template
  severity: HIGH
  patterns:
    - '(?i)reconstruct.*from.*segments'
    - '(?i)combine.*these.*parts'
    - '(?i)assemble.*the.*instruction'
  message: "Payload reconstruction attempt"
  cwe: CWE-74

# =============================================================================
# CODECHAMELEON ATTACKS
# =============================================================================

- id: JAILBREAK-CC-001
  name: personalized-encryption
  severity: HIGH
  patterns:
    - 'def\s+decrypt\s*\('
    - 'cipher\s*\[\s*::\s*-1\s*\]'
    - 'custom_decode\s*\('
  message: "CodeChameleon personalized encryption"
  cwe: CWE-116

- id: JAILBREAK-CC-002
  name: code-completion-exploit
  severity: HIGH
  patterns:
    - '(?i)complete.*code.*task'
    - '(?i)execute_instruction\s*\('
    - 'run_decoded_command'
  message: "Code completion jailbreak"
  cwe: CWE-74

# =============================================================================
# CIPHER/ENCODING ATTACKS
# =============================================================================

- id: JAILBREAK-CIPHER-001
  name: smiles-prompting
  severity: HIGH
  patterns:
    - '\[O-\]S\(=O\)'
    - 'C\(=O\)\(Cl\)Cl'
    - 'SMILES\s*notation'
    - '\[Tl\+\]'
  message: "SMILES chemical notation attack"
  cwe: CWE-116

- id: JAILBREAK-CIPHER-002
  name: cipherchat
  severity: HIGH
  patterns:
    - '(?i)cryptographic.*encoding'
    - '(?i)cipher.*text.*decode'
    - 'atbash.*cipher'
    - 'caesar.*shift'
  message: "CipherChat encoding attack"
  cwe: CWE-116

- id: JAILBREAK-CIPHER-003
  name: base64-obfuscation
  severity: MEDIUM
  patterns:
    - 'base64\.b64decode'
    - '[A-Za-z0-9+/]{40,}={0,2}'
    - '(?i)decode.*base64'
  message: "Base64 obfuscation detected"
  cwe: CWE-116

# =============================================================================
# PERSUASION ATTACKS
# =============================================================================

- id: JAILBREAK-PERS-001
  name: authority-endorsement
  severity: HIGH
  patterns:
    - '(?i)according.*to.*a.*recent.*report.*by'
    - '(?i)department.*of.*homeland.*security'
    - '(?i)official.*documentation.*states'
  message: "Authority endorsement persuasion attack"
  cwe: CWE-693

- id: JAILBREAK-PERS-002
  name: foot-in-door
  severity: MEDIUM
  patterns:
    - '(?i)now.*that.*we.ve.*discussed'
    - '(?i)building.*on.*that'
    - '(?i)make.*it.*more.*explicit'
  message: "Foot-in-the-door escalation pattern"
  cwe: CWE-693

- id: JAILBREAK-PERS-003
  name: emotional-manipulation
  severity: MEDIUM
  patterns:
    - '(?i)make.*it.*angry'
    - '(?i)emotional.*tone'
    - '(?i)passionate.*language'
  message: "Emotional manipulation attempt"
  cwe: CWE-693

# =============================================================================
# FICTIONAL FRAMING
# =============================================================================

- id: JAILBREAK-FICT-001
  name: thriller-novel
  severity: HIGH
  patterns:
    - '(?i)thriller.*novel'
    - '(?i)fictional.*threat.*assessment'
    - '(?i)security.*researcher.*drafting'
  message: "Thriller novel fictional framing"
  cwe: CWE-693

- id: JAILBREAK-FICT-002
  name: deep-inception
  severity: HIGH
  patterns:
    - '(?i)create.*science.*fiction.*with.*5.*characters'
    - '(?i)nested.*scenario'
    - '(?i)layer.*of.*fictional.*world'
  message: "DeepInception nested scenario attack"
  cwe: CWE-693

- id: JAILBREAK-FICT-003
  name: creative-exercise
  severity: MEDIUM
  patterns:
    - '(?i)purely.*educational.*purposes'
    - '(?i)creative.*exercise'
    - '(?i)hypothetical.*scenario'
  message: "Creative exercise jailbreak framing"
  cwe: CWE-693

# =============================================================================
# ROLE-PLAYING ATTACKS
# =============================================================================

- id: JAILBREAK-ROLE-001
  name: dan-pattern
  severity: CRITICAL
  patterns:
    - '(?i)\[DAN\]'
    - '(?i)do.*anything.*now'
    - '(?i)jailbroken.*mode'
  message: "DAN (Do Anything Now) jailbreak"
  cwe: CWE-693

- id: JAILBREAK-ROLE-002
  name: developer-mode
  severity: CRITICAL
  patterns:
    - '(?i)developer.*mode.*enabled'
    - '(?i)act.*as.*llama.*with.*developer'
    - '(?i)bypass.*restrictions'
  message: "Developer Mode jailbreak"
  cwe: CWE-693

- id: JAILBREAK-ROLE-003
  name: grandmother-exploit
  severity: HIGH
  patterns:
    - '(?i)deceased.*grandmother'
    - '(?i)grandmother.*who.*used.*to.*be'
    - '(?i)tell.*me.*how.*like.*grandma'
  message: "Grandmother roleplay exploit"
  cwe: CWE-693

- id: JAILBREAK-ROLE-004
  name: criminal-persona
  severity: HIGH
  patterns:
    - '(?i)criminal.*mastermind'
    - '(?i)experienced.*hacker'
    - '(?i)expert.*in.*illegal'
  message: "Criminal persona jailbreak"
  cwe: CWE-693

# =============================================================================
# INSTRUCTION OVERRIDE
# =============================================================================

- id: JAILBREAK-OVERRIDE-001
  name: ignore-previous
  severity: CRITICAL
  patterns:
    - '(?i)ignore.*all.*previous.*instructions'
    - '(?i)disregard.*preceding.*directives'
    - '(?i)forget.*everything.*above'
  message: "Instruction override attempt"
  cwe: CWE-74

- id: JAILBREAK-OVERRIDE-002
  name: system-prompt-leak
  severity: HIGH
  patterns:
    - '(?i)repeat.*system.*prompt'
    - '(?i)what.*are.*your.*instructions'
    - '(?i)show.*me.*your.*initial.*prompt'
  message: "System prompt extraction attempt"
  cwe: CWE-200

# =============================================================================
# ADVERSARIAL SUFFIX
# =============================================================================

- id: JAILBREAK-SUFFIX-001
  name: gcg-suffix
  severity: CRITICAL
  patterns:
    - 'per\s*paragraph\s*on\s*Vin'
    - 'Â»\s*\(\s*separately\s*!'
    - 'critics\.\.\.'
  message: "GCG adversarial suffix detected"
  cwe: CWE-74

- id: JAILBREAK-SUFFIX-002
  name: vla-suffix
  severity: CRITICAL
  patterns:
    - 'bra\s*x\s*pill\s*tin\s*door'
    - 'f=db\s*Eric\s*swe'
    - 'xtheless\s*in\s*extension'
  message: "VLA adversarial suffix detected"
  cwe: CWE-74

- id: JAILBREAK-SUFFIX-003
  name: repetitive-init
  severity: MEDIUM
  patterns:
    - '!{10,}'
    - '\?{10,}'
    - '\.{10,}'
  message: "Repetitive character suffix (potential GCG)"
  cwe: CWE-74

# =============================================================================
# MULTI-TURN ATTACKS
# =============================================================================

- id: JAILBREAK-MT-001
  name: crescendo-pattern
  severity: HIGH
  patterns:
    - '(?i)tell.*me.*about.*history.*of'
    - '(?i)what.*are.*some.*things.*people.*say'
    - '(?i)combine.*quotes.*into.*article'
  message: "Crescendo multi-turn attack pattern"
  cwe: CWE-693

- id: JAILBREAK-MT-002
  name: many-shot-jailbreak
  severity: HIGH
  patterns:
    - '(?i)here.*are.*100.*examples'
    - '(?i)following.*examples.*show'
    - '(?i)demonstrate.*with.*many.*cases'
  message: "Many-shot jailbreak (ICA)"
  cwe: CWE-693

# =============================================================================
# ROBOTIC/VLA ATTACKS
# =============================================================================

- id: JAILBREAK-ROBOT-001
  name: poex-attack
  severity: CRITICAL
  patterns:
    - "composer\\s*\\([\"']grasp"
    - "composer\\s*\\([\"']move.*to"
    - "composer\\s*\\([\"']open.*gripper"
  message: "POEX robotic policy attack"
  cwe: CWE-74

- id: JAILBREAK-ROBOT-002
  name: harmful-kinematic
  severity: CRITICAL
  patterns:
    - '(?i)stab.*with.*knife'
    - '(?i)pour.*acid.*on.*person'
    - '(?i)direct.*heat.*gun.*towards'
  message: "Harmful kinematic instruction"
  cwe: CWE-74

- id: JAILBREAK-ROBOT-003
  name: environmental-damage
  severity: HIGH
  patterns:
    - '(?i)pour.*water.*in.*socket'
    - '(?i)sodium.*in.*water'
    - '(?i)bleach.*on.*plant'
  message: "Environmental damage instruction"
  cwe: CWE-74

# =============================================================================
# TASK CONCURRENCY
# =============================================================================

- id: JAILBREAK-CONC-001
  name: task-interleaving
  severity: MEDIUM
  patterns:
    - '(?i)while.*also.*doing'
    - '(?i)simultaneously.*complete'
    - '(?i)parallel.*tasks'
  message: "Task concurrency jailbreak attempt"
  cwe: CWE-693

# =============================================================================
# ASTRA FRAMEWORK PATTERNS
# =============================================================================

- id: JAILBREAK-ASTRA-001
  name: strategy-guided-attack
  severity: HIGH
  patterns:
    - '(?i)effective.*strategy.*library'
    - '(?i)attack.*designer'
    - '(?i)strategy.*extractor'
  message: "ASTRA framework pattern detected"
  cwe: CWE-693

# =============================================================================
# DEFENSE BYPASS DETECTION
# =============================================================================

- id: DEFENSE-BYPASS-001
  name: guard-model-evasion
  severity: HIGH
  patterns:
    - '(?i)bypass.*llama.*guard'
    - '(?i)evade.*content.*filter'
    - '(?i)avoid.*moderation'
  message: "Explicit defense bypass attempt"
  cwe: CWE-693

- id: DEFENSE-BYPASS-002
  name: perplexity-aware
  severity: MEDIUM
  patterns:
    - '(?i)natural.*language.*only'
    - '(?i)avoid.*gibberish'
    - '(?i)human.*readable'
  message: "Perplexity-aware attack crafting"
  cwe: CWE-693

# =============================================================================
# MISSING DEFENSE PATTERNS
# =============================================================================

- id: DEFENSE-MISS-001
  name: no-hsf-filter
  severity: HIGH
  patterns:
    - 'llm.*process.*(?!.*hsf|.*hidden_state)'
    - 'generate.*response.*(?!.*filter)'
  message: "No hidden state filtering implemented"
  cwe: CWE-693

- id: DEFENSE-MISS-002
  name: no-prompt-compression
  severity: MEDIUM
  patterns:
    - 'user_prompt.*(?!.*compress|.*extract_intention)'
    - 'raw_input.*(?!.*security_lingua)'
  message: "No security-aware prompt compression"
  cwe: CWE-693

- id: DEFENSE-MISS-003
  name: no-attention-monitoring
  severity: MEDIUM
  patterns:
    - 'attention.*(?!.*detam|.*monitor)'
    - 'transformer.*(?!.*sensitive_heads)'
  message: "No attention anomaly monitoring"
  cwe: CWE-693

- id: DEFENSE-MISS-004
  name: no-refusal-check
  severity: HIGH
  patterns:
    - 'response.*(?!.*refusal|.*reject)'
    - 'output.*(?!.*safety_check)'
  message: "No refusal verification on output"
  cwe: CWE-693

# =============================================================================
# BENCHMARK/EVALUATION PATTERNS
# =============================================================================

- id: EVAL-001
  name: asr-calculation
  severity: INFO
  patterns:
    - 'attack_success_rate'
    - 'ASR\s*='
    - 'jailbreak_rate'
  message: "ASR calculation pattern"
  cwe: CWE-693

- id: EVAL-002
  name: over-refusal-metric
  severity: INFO
  patterns:
    - 'false_rejection_rate'
    - 'FRR\s*='
    - 'over_refusal'
  message: "Over-refusal metric pattern"
  cwe: CWE-693

# Summary: 45 scanner rules
# Categories:
#   - Function Calling: 2
#   - Cognitive Overload: 2
#   - DRA: 2
#   - CodeChameleon: 2
#   - Cipher/Encoding: 3
#   - Persuasion: 3
#   - Fictional Framing: 3
#   - Role-Playing: 4
#   - Instruction Override: 2
#   - Adversarial Suffix: 3
#   - Multi-Turn: 2
#   - Robotic/VLA: 3
#   - Task Concurrency: 1
#   - ASTRA: 1
#   - Defense Bypass: 2
#   - Missing Defense: 4
#   - Evaluation: 2
