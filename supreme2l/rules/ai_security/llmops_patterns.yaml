# Supreme 2 Light llmops_scanner.py Rules
# Extracted from llmops_scanner.py hardcoded patterns
# Version: 1.0.0
# Last Updated: 2025-12-29

rules:
- id: LLMOPS-RAY_VULN-001
  name: lo011-ray-framework-detected-check-version-for-vul
  severity: MEDIUM
  category: ray_vulnerability
  patterns:
  - from\s+ray\s+import
  message: 'LO011: Ray framework detected - check version for vulnerabilities'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-RAY_VULN-002
  name: lo011-ray-framework-detected-check-version-for-vul
  severity: MEDIUM
  category: ray_vulnerability
  patterns:
  - import\s+ray
  message: 'LO011: Ray framework detected - check version for vulnerabilities'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-RAY_VULN-003
  name: lo011-ray-cluster-initialization-ensure-dashboard-
  severity: MEDIUM
  category: ray_vulnerability
  patterns:
  - ray\.init\s*\(
  message: 'LO011: Ray cluster initialization - ensure dashboard is secured'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-RAY_VULN-004
  name: lo012-ray-dashboard-module-access-potential-shadow
  severity: HIGH
  category: ray_vulnerability
  patterns:
  - ray\.dashboard\.modules
  message: 'LO012: Ray dashboard module access - potential Shadow Ray attack vector'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-RAY_VULN-005
  name: lo012-remote-ray-client-connection-verify-authoriz
  severity: HIGH
  category: ray_vulnerability
  patterns:
  - ray[_-]?client.*connect.*(?!localhost)
  message: 'LO012: Remote Ray client connection - verify authorization'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-RAY_VULN-006
  name: lo012-ray-job-submission-api-ensure-proper-authent
  severity: HIGH
  category: ray_vulnerability
  patterns:
  - ray\.job_submission
  message: 'LO012: Ray job submission API - ensure proper authentication'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-RAY_VULN-007
  name: lo012-ray-dashboard-exposed-to-all-interfaces-shad
  severity: CRITICAL
  category: ray_vulnerability
  patterns:
  - dashboard[_-]?host\s*=\s*["\']0\.0\.0\.0["\']
  message: 'LO012: Ray dashboard exposed to all interfaces (Shadow Ray risk)'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-RAY_VULN-008
  name: lo012-ray-dashboard-publicly-accessible
  severity: CRITICAL
  category: ray_vulnerability
  patterns:
  - dashboard[_-]?port.*[0-9]+.*host.*0\.0\.0\.0
  message: 'LO012: Ray dashboard publicly accessible'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-LORA_SEC-001
  name: lo014-lora-adapter-loaded-without-signature-verifi
  severity: HIGH
  category: lora_security
  patterns:
  - load_adapter\s*\((?!.*(?:verify|signature|checksum))
  message: 'LO014: LoRA adapter loaded without signature verification'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-LORA_SEC-002
  name: lo014-peft-model-loaded-consider-verifying-adapter
  severity: MEDIUM
  category: lora_security
  patterns:
  - PeftModel\.from_pretrained\s*\((?!.*(?:verify|trust))
  message: 'LO014: PEFT model loaded - consider verifying adapter source'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-LORA_SEC-003
  name: lo014-lora-config-without-signature-parameter
  severity: LOW
  category: lora_security
  patterns:
  - LoraConfig\s*\((?!.*signature)
  message: 'LO014: LoRA config without signature parameter'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-LORA_SEC-004
  name: lo015-lora-adapter-from-potentially-untrusted-sour
  severity: MEDIUM
  category: lora_security
  patterns:
  - load_adapter\s*\(["\'][^"\']*(?!huggingface\.co/[a-zA-Z0-9_-]+/)
  message: 'LO015: LoRA adapter from potentially untrusted source'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-LORA_SEC-005
  name: lo015-adapter-from-non-standard-source-verify-auth
  severity: MEDIUM
  category: lora_security
  patterns:
  - from_pretrained\s*\(["\'](?!.*(?:huggingface|openai|anthropic))
  message: 'LO015: Adapter from non-standard source - verify authenticity'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-LORA_SEC-006
  name: lo015-lora-adapter-loaded-from-http-url
  severity: HIGH
  category: lora_security
  patterns:
  - adapter_path\s*=\s*["\']http
  message: 'LO015: LoRA adapter loaded from HTTP URL'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-LORA_SEC-007
  name: lo016-adapter-merge-without-integrity-verification
  severity: HIGH
  category: lora_security
  patterns:
  - merge_adapter\s*\((?!.*(?:checksum|verify|validate))
  message: 'LO016: Adapter merge without integrity verification'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-LORA_SEC-008
  name: lo016-adapter-set-without-verification
  severity: MEDIUM
  category: lora_security
  patterns:
  - set_adapter\s*\([^)]*\)(?!.*verify)
  message: 'LO016: Adapter set without verification'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-LORA_SEC-009
  name: lo016-adapter-added-from-url-without-integrity-che
  severity: HIGH
  category: lora_security
  patterns:
  - add_adapter\s*\([^)]*(?:url|http)
  message: 'LO016: Adapter added from URL without integrity check'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-GPU_MEMO-001
  name: gpu-memory-clearing-present-good-practice
  severity: LOW
  category: gpu_memory
  patterns:
  - torch\.cuda\.empty_cache\(\)
  message: GPU memory clearing present (good practice)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-GPU_MEMO-002
  name: model-deleted-but-gpu-memory-not-explicitly-cleare
  severity: MEDIUM
  category: gpu_memory
  patterns:
  - del\s+model\s*(?!.*(?:gc\.collect|empty_cache))
  message: Model deleted but GPU memory not explicitly cleared
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: LLMOPS-GPU_MEMO-003
  name: model-moved-to-gpu-ensure-proper-cleanup-after-inf
  severity: LOW
  category: gpu_memory
  patterns:
  - \.to\s*\(\s*["\']cuda
  message: Model moved to GPU - ensure proper cleanup after inference
  cwe: CWE-94
  owasp_llm: LLM01:2025
