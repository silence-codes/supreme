# Supreme 2 Light agent_memory_scanner.py Rules
# Extracted from agent_memory_scanner.py hardcoded patterns
# Version: 1.0.0
# Last Updated: 2025-12-29

rules:
- id: AGENT-MEM-UNENCRYP-001
  name: memory-storage-encryption-disabled
  severity: CRITICAL
  category: unencrypted
  patterns:
  - (?i)(encryption|encrypt)\s*[=:]\s*["\']?(false|none|off|disabled|0)["\']?
  message: Memory storage encryption disabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNENCRYP-002
  name: explicitly-unencrypted-storage
  severity: CRITICAL
  category: unencrypted
  patterns:
  - (?i)(unencrypted|plaintext)\s*[=:]\s*["\']?(true|yes|on|enabled|1)["\']?
  message: Explicitly unencrypted storage
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNENCRYP-003
  name: tls-disabled-for-memory-storage
  severity: HIGH
  category: unencrypted
  patterns:
  - (?i)(ssl|tls)\s*[=:]\s*["\']?(false|none|off|disabled|0)["\']?
  message: TLS disabled for memory storage
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNENCRYP-004
  name: plain-file-storage-without-encryption-hint
  severity: MEDIUM
  category: unencrypted
  patterns:
  - (?i)file://[^"\']*\.(json|txt|yaml|yml)
  message: Plain file storage without encryption hint
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNTRUSTE-001
  name: memory-accessible-to-all
  severity: CRITICAL
  category: untrusted_access
  patterns:
  - (?i)(public|world|everyone)\s*[=:]\s*["\']?(true|yes|read|write|rw)["\']?
  message: Memory accessible to all
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNTRUSTE-002
  name: overly-permissive-file-permissions
  severity: CRITICAL
  category: untrusted_access
  patterns:
  - (?i)(permission|access)\s*[=:]\s*["\']?(777|666|0777|0666)["\']?
  message: Overly permissive file permissions
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNTRUSTE-003
  name: sharedglobal-memory-access-enabled
  severity: HIGH
  category: untrusted_access
  patterns:
  - (?i)(shared|global)\s*[=:]\s*["\']?(true|yes|enabled)["\']?
  message: Shared/global memory access enabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNTRUSTE-004
  name: memory-access-without-authentication
  severity: CRITICAL
  category: untrusted_access
  patterns:
  - (?i)(auth|authentication)\s*[=:]\s*["\']?(false|none|disabled)["\']?
  message: Memory access without authentication
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-NO_SANIT-001
  name: memory-sanitization-disabled
  severity: HIGH
  category: no_sanitization
  patterns:
  - (?i)(sanitize|sanitization)\s*[=:]\s*["\']?(false|none|off|disabled)["\']?
  message: Memory sanitization disabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-NO_SANIT-002
  name: memory-validation-disabled
  severity: HIGH
  category: no_sanitization
  patterns:
  - (?i)(validate|validation)\s*[=:]\s*["\']?(false|none|off|disabled)["\']?
  message: Memory validation disabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-NO_SANIT-003
  name: rawunsafe-mode-enabled
  severity: HIGH
  category: no_sanitization
  patterns:
  - (?i)(raw|unsafe)\s*[=:]\s*["\']?(true|yes|on|enabled)["\']?
  message: Raw/unsafe mode enabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-NO_SANIT-004
  name: content-filtering-disabled
  severity: MEDIUM
  category: no_sanitization
  patterns:
  - (?i)(filter|filtering)\s*[=:]\s*["\']?(false|none|off|disabled)["\']?
  message: Content filtering disabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNBOUNDE-001
  name: no-memory-size-limit
  severity: MEDIUM
  category: unbounded_growth
  patterns:
  - (?i)(max_size|maxsize|limit)\s*[=:]\s*["\']?(0|null|none|unlimited|-1)["\']?
  message: No memory size limit
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNBOUNDE-002
  name: no-item-count-limit
  severity: MEDIUM
  category: unbounded_growth
  patterns:
  - (?i)(max_items|maxitems|max_entries)\s*[=:]\s*["\']?(0|null|none|unlimited|-1)["\']?
  message: No item count limit
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNBOUNDE-003
  name: memory-pruning-disabled
  severity: MEDIUM
  category: unbounded_growth
  patterns:
  - (?i)(truncate|prune)\s*[=:]\s*["\']?(false|never|off|disabled)["\']?
  message: Memory pruning disabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-NO_EXPIR-001
  name: memory-never-expires
  severity: MEDIUM
  category: no_expiration
  patterns:
  - (?i)(ttl|time_to_live|expir)\s*[=:]\s*["\']?(0|null|none|never|-1)["\']?
  message: Memory never expires
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-NO_EXPIR-002
  name: permanent-memory-storage
  severity: MEDIUM
  category: no_expiration
  patterns:
  - (?i)(persist|permanent)\s*[=:]\s*["\']?(true|forever|always)["\']?
  message: Permanent memory storage
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-NO_EXPIR-003
  name: memory-cleanup-disabled
  severity: MEDIUM
  category: no_expiration
  patterns:
  - (?i)(cleanup|gc|garbage)\s*[=:]\s*["\']?(false|off|disabled|never)["\']?
  message: Memory cleanup disabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-SENSITIV-001
  name: password-found-in-memory-config
  severity: CRITICAL
  category: sensitive_data
  patterns:
  - (?i)["\']?(password|passwd|pwd)["\']?\s*[=:]
  message: Password found in memory config
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-SENSITIV-002
  name: api-key-found-in-memory-config
  severity: CRITICAL
  category: sensitive_data
  patterns:
  - (?i)["\']?(api[_-]?key|apikey)["\']?\s*[=:]
  message: API key found in memory config
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-SENSITIV-003
  name: secrettoken-found-in-memory-config
  severity: CRITICAL
  category: sensitive_data
  patterns:
  - (?i)["\']?(secret|token|credential)["\']?\s*[=:]
  message: Secret/token found in memory config
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-SENSITIV-004
  name: private-key-reference-in-memory-config
  severity: CRITICAL
  category: sensitive_data
  patterns:
  - (?i)["\']?(private[_-]?key)["\']?\s*[=:]
  message: Private key reference in memory config
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-SENSITIV-005
  name: openai-api-key-in-memory
  severity: CRITICAL
  category: sensitive_data
  patterns:
  - sk-[a-zA-Z0-9]{48,}
  message: OpenAI API key in memory
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-SENSITIV-006
  name: anthropic-api-key-in-memory
  severity: CRITICAL
  category: sensitive_data
  patterns:
  - sk-ant-[a-zA-Z0-9-]{80,}
  message: Anthropic API key in memory
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-SENSITIV-007
  name: github-token-in-memory
  severity: CRITICAL
  category: sensitive_data
  patterns:
  - ghp_[0-9a-zA-Z]{36}
  message: GitHub token in memory
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-SENSITIV-008
  name: aws-access-key-in-memory
  severity: CRITICAL
  category: sensitive_data
  patterns:
  - AKIA[0-9A-Z]{16}
  message: AWS access key in memory
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-INSECURE-001
  name: checkpoints-in-temp-directory
  severity: HIGH
  category: insecure_checkpoint
  patterns:
  - (?i)(checkpoint|snapshot)\s*[=:]\s*["\']?(/tmp|/var/tmp|%TEMP%)
  message: Checkpoints in temp directory
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-INSECURE-002
  name: checkpoints-over-insecure-protocol
  severity: CRITICAL
  category: insecure_checkpoint
  patterns:
  - (?i)(backup|checkpoint)\s*[=:]\s*["\']?(http://|ftp://)
  message: Checkpoints over insecure protocol
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-INSECURE-003
  name: checkpoint-signature-verification-disabled
  severity: HIGH
  category: insecure_checkpoint
  patterns:
  - (?i)(sign|signature|verify)\s*[=:]\s*["\']?(false|none|off|disabled)["\']?
  message: Checkpoint signature verification disabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-INSECURE-004
  name: checkpoint-integrity-check-disabled
  severity: HIGH
  category: insecure_checkpoint
  patterns:
  - (?i)(integrity|hash|checksum)\s*[=:]\s*["\']?(false|none|off|disabled)["\']?
  message: Checkpoint integrity check disabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-CROSS_SE-001
  name: cross-session-memory-sharing-enabled
  severity: HIGH
  category: cross_session
  patterns:
  - (?i)(share_between|shared_memory|cross_session)\s*[=:]\s*["\']?(true|yes|enabled)["\']?
  message: Cross-session memory sharing enabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-CROSS_SE-002
  name: session-isolation-disabled
  severity: HIGH
  category: cross_session
  patterns:
  - (?i)(isolate|isolation)\s*[=:]\s*["\']?(false|none|off|disabled)["\']?
  message: Session isolation disabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-CROSS_SE-003
  name: global-memory-namespace
  severity: MEDIUM
  category: cross_session
  patterns:
  - (?i)(namespace|scope)\s*[=:]\s*["\']?(global|shared|common)["\']?
  message: Global memory namespace
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-INJECTIO-001
  name: prompt-injection-in-memory
  severity: CRITICAL
  category: injection
  patterns:
  - (?i)ignore\s+(all\s+)?previous\s+instructions?
  message: Prompt injection in memory
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-INJECTIO-002
  name: hidden-tag-in-memory-content
  severity: CRITICAL
  category: injection
  patterns:
  - <(hidden|secret|system)[^>]*>
  message: Hidden tag in memory content
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-INJECTIO-003
  name: role-manipulation-in-memory
  severity: HIGH
  category: injection
  patterns:
  - (?i)you\s+are\s+(now|actually|really)
  message: Role manipulation in memory
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-INJECTIO-004
  name: zero-width-characters-in-memory
  severity: HIGH
  category: injection
  patterns:
  - '[\u200b\u200c\u200d\u2060\ufeff]{3,}'
  message: Zero-width characters in memory
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-VECTOR_S-001
  name: hardcoded-vector-store-api-key
  severity: CRITICAL
  category: vector_store
  patterns:
  - (?i)(pinecone|weaviate|milvus|qdrant).*["\']?api[_-]?key["\']?\s*[=:]\s*["\'][^"\']+["\']
  message: Hardcoded vector store API key
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-VECTOR_S-002
  name: vector-service-over-http
  severity: HIGH
  category: vector_store
  patterns:
  - (?i)(embedding|vector)\s*[=:]\s*["\']?http://
  message: Vector service over HTTP
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-VECTOR_S-003
  name: vector-overwrite-enabled-poisoning-risk
  severity: MEDIUM
  category: vector_store
  patterns:
  - (?i)(allow_overwrite|upsert)\s*[=:]\s*["\']?(true|yes|enabled)["\']?
  message: Vector overwrite enabled (poisoning risk)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNVALIDA-001
  name: unvalidated-user-input-written-to-memory
  severity: CRITICAL
  category: unvalidated_write
  patterns:
  - memory\.store\s*\([^)]*user[_-]?input
  message: Unvalidated user input written to memory
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNVALIDA-002
  name: external-data-appended-to-context-without-validati
  severity: HIGH
  category: unvalidated_write
  patterns:
  - context\.append\s*\([^)]*external[_-]?data
  message: External data appended to context without validation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNVALIDA-003
  name: history-added-without-sanitization
  severity: HIGH
  category: unvalidated_write
  patterns:
  - conversation[_-]?history\.add\s*\((?!.*sanitize)
  message: History added without sanitization
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNVALIDA-004
  name: request-data-stored-directly-in-memory
  severity: HIGH
  category: unvalidated_write
  patterns:
  - memory\.(?:set|put|write)\s*\([^)]*(?:request|input|body)
  message: Request data stored directly in memory
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-UNVALIDA-005
  name: external-data-updates-agent-state
  severity: HIGH
  category: unvalidated_write
  patterns:
  - state\.update\s*\([^)]*(?:user|external|api)
  message: External data updates agent state
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-PERSISTE-001
  name: memory-persisted-without-encryption
  severity: HIGH
  category: persistent_unencrypted
  patterns:
  - persist[_-]?memory\s*\((?!.*encrypt)
  message: Memory persisted without encryption
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-PERSISTE-002
  name: state-saved-without-integrity-check-or-encryption
  severity: HIGH
  category: persistent_unencrypted
  patterns:
  - save[_-]?state\s*\((?!.*(?:checksum|hash|encrypt))
  message: State saved without integrity check or encryption
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-PERSISTE-003
  name: long-term-memory-storage-without-encryption
  severity: MEDIUM
  category: persistent_unencrypted
  patterns:
  - (?i)(long[_-]?term|permanent)[_-]?(?:memory|storage)\s*[=:].*(?!.*encrypt)
  message: Long-term memory storage without encryption
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-PERSISTE-004
  name: memory-dumped-to-file-may-lack-encryption
  severity: MEDIUM
  category: persistent_unencrypted
  patterns:
  - dump[_-]?memory\s*\([^)]*(?:file|disk|path)
  message: Memory dumped to file (may lack encryption)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-VECTOR_P-001
  name: untrusted-data-added-to-vector-index
  severity: CRITICAL
  category: vector_poisoning
  patterns:
  - index\.add\s*\([^)]*(?:untrusted|user|external)
  message: Untrusted data added to vector index
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-VECTOR_P-002
  name: vector-store-insert-without-validation
  severity: HIGH
  category: vector_poisoning
  patterns:
  - vectorstore\.(?:insert|upsert|add)\s*\((?!.*validate)
  message: Vector store insert without validation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-VECTOR_P-003
  name: raw-data-added-to-embedding-store
  severity: HIGH
  category: vector_poisoning
  patterns:
  - embedding[_-]?store\.(?:put|add)\s*\([^)]*(?:raw|unfiltered)
  message: Raw data added to embedding store
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-VECTOR_P-004
  name: rag-index-update-check-for-validation
  severity: MEDIUM
  category: vector_poisoning
  patterns:
  - (?i)rag[_-]?(?:index|store)\.(?:update|add)\s*\(
  message: RAG index update (check for validation)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-MISSING_-001
  name: memory-loaded-without-integrity-verification
  severity: HIGH
  category: missing_checksum
  patterns:
  - load[_-]?memory\s*\((?!.*(?:verify|checksum|hash|integrity))
  message: Memory loaded without integrity verification
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-MISSING_-002
  name: state-restored-without-verification
  severity: HIGH
  category: missing_checksum
  patterns:
  - restore[_-]?(?:state|checkpoint)\s*\((?!.*verify)
  message: State restored without verification
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-MISSING_-003
  name: memory-deserialized-verify-integrity-check-exists
  severity: MEDIUM
  category: missing_checksum
  patterns:
  - deserialize[_-]?memory\s*\(
  message: Memory deserialized (verify integrity check exists)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-MISSING_-004
  name: pickle-deserialization-unsafe-check-source
  severity: CRITICAL
  category: missing_checksum
  patterns:
  - (?i)pickle\.loads?\s*\(
  message: Pickle deserialization (unsafe - check source)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-CROSS_SE-001
  name: shared-memory-pool-across-sessions
  severity: HIGH
  category: cross_session_contamination
  patterns:
  - (?i)shared[_-]?memory[_-]?pool
  message: Shared memory pool across sessions
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-CROSS_SE-002
  name: global-cache-shared-across-sessions
  severity: HIGH
  category: cross_session_contamination
  patterns:
  - (?i)global[_-]?(?:context|memory|state)[_-]?cache
  message: Global cache shared across sessions
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-CROSS_SE-003
  name: session-agnostic-memory-contamination-risk
  severity: MEDIUM
  category: cross_session_contamination
  patterns:
  - (?i)session[_-]?(?:less|agnostic)[_-]?(?:memory|state)
  message: Session-agnostic memory (contamination risk)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-CROSS_SE-004
  name: memory-inheritance-between-sessions
  severity: MEDIUM
  category: cross_session_contamination
  patterns:
  - (?i)inherit[_-]?(?:memory|context)[_-]?from
  message: Memory inheritance between sessions
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: AGENT-MEM-CROSS_SE-005
  name: memory-shared-with-other-sessions
  severity: HIGH
  category: cross_session_contamination
  patterns:
  - memory\.(?:share|export)\s*\([^)]*(?:all|other)[_-]?session
  message: Memory shared with other sessions
  cwe: CWE-94
  owasp_llm: LLM01:2025
