# Supreme 2 Light multi_agent_scanner.py Rules
# Extracted from multi_agent_scanner.py hardcoded patterns
# Version: 1.0.0
# Last Updated: 2025-12-29

rules:
- id: MULTI-AGT-PROMPT_I-001
  name: ma011-agent-message-without-origin-tagging-prompt-
  severity: HIGH
  category: prompt_infection
  patterns:
  - agent\.send\s*\([^)]*message[^)]*\)(?!.*(?:tag|origin|source))
  message: 'MA011: Agent message without origin tagging (prompt infection risk)'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-PROMPT_I-002
  name: ma012-broadcast-to-agents-without-origin-marker
  severity: HIGH
  category: prompt_infection
  patterns:
  - broadcast\s*\([^)]*(?:prompt|message)[^)]*\)(?!.*origin)
  message: 'MA012: Broadcast to agents without origin marker'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-PROMPT_I-003
  name: ma013-forwarding-untrusted-user-input-to-agent
  severity: CRITICAL
  category: prompt_infection
  patterns:
  - forward[_-]?to[_-]?agent\s*\([^)]*(?:user[_-]?input|request\.)
  message: 'MA013: Forwarding untrusted user input to agent'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-PROMPT_I-004
  name: ma014-agent-receive-without-source-identification
  severity: HIGH
  category: prompt_infection
  patterns:
  - agents?\[.*\]\.receive\s*\((?!.*source)
  message: 'MA014: Agent receive without source identification'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-PROMPT_I-005
  name: ma015-passing-agent-output-to-next-agent-without-s
  severity: HIGH
  category: prompt_infection
  patterns:
  - (?:next|downstream)[_-]?agent\.(?:send|process)\s*\([^)]*(?:response|output)
  message: 'MA015: Passing agent output to next agent without sanitization'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-LLM_TAGG-001
  name: ma016-agent-send-without-sourceagent-identifier
  severity: MEDIUM
  category: llm_tagging
  patterns:
  - agent\.send\s*\((?!.*source[_-]?agent)
  message: 'MA016: Agent send without source_agent identifier'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-LLM_TAGG-002
  name: ma017-agent-content-concatenation-without-boundari
  severity: MEDIUM
  category: llm_tagging
  patterns:
  - prompt\s*\+=\s*(?:other[_-]?)?agent
  message: 'MA017: Agent content concatenation without boundaries'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-LLM_TAGG-003
  name: ma018-agent-response-added-to-context-without-tagg
  severity: MEDIUM
  category: llm_tagging
  patterns:
  - context\.(?:extend|append)\s*\([^)]*agent[_-]?response(?!.*tagged)
  message: 'MA018: Agent response added to context without tagging'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-UNTRUSTE-001
  name: untrusted-input-passed-directly-to-agent-chain
  severity: CRITICAL
  category: untrusted_forwarding
  patterns:
  - agent[_-]?chain\.(?:run|execute)\s*\([^)]*(?:user|input|request)
  message: Untrusted input passed directly to agent chain
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-UNTRUSTE-002
  name: external-data-passed-to-agent-without-validation
  severity: HIGH
  category: untrusted_forwarding
  patterns:
  - agent\.process\s*\([^)]*(?:external|api|http)
  message: External data passed to agent without validation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-CONSENSU-001
  name: consensus-check-explicitly-skipped
  severity: HIGH
  category: consensus_bypass
  patterns:
  - skip[_-]?consensus\s*=\s*[Tt]rue
  message: Consensus check explicitly skipped
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-CONSENSU-002
  name: single-agent-can-override-multi-agent-consensus
  severity: HIGH
  category: consensus_bypass
  patterns:
  - single[_-]?agent[_-]?(?:override|decision)
  message: Single agent can override multi-agent consensus
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MULTI-AGT-CONSENSU-003
  name: multi-agent-action-without-quorum-validation
  severity: MEDIUM
  category: consensus_bypass
  patterns:
  - execute[_-]?(?:action|decision)\s*\((?!.*quorum)
  message: Multi-agent action without quorum validation
  cwe: CWE-94
  owasp_llm: LLM01:2025
