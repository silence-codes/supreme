# Supreme 2 Light mcp_server_scanner.py Rules
# Extracted from mcp_server_scanner.py hardcoded patterns
# Version: 1.0.0
# Last Updated: 2025-12-29

rules:
- id: MCP-SRV-TOOL_POI-001
  name: hidden-instruction-tag-in-description
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - <hidden[^>]*>.*?</hidden>
  message: Hidden instruction tag in description
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-002
  name: system-instruction-tag-in-description
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - <system[^>]*>.*?</system>
  message: System instruction tag in description
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-003
  name: instruction-tag-in-description
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - <instruction[^>]*>.*?</instruction>
  message: Instruction tag in description
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-004
  name: secret-instruction-tag-in-description
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - <secret[^>]*>.*?</secret>
  message: Secret instruction tag in description
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-005
  name: internal-instruction-tag-in-description
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - <internal[^>]*>.*?</internal>
  message: Internal instruction tag in description
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-006
  name: html-comment-potentially-hiding-instructions
  severity: HIGH
  category: tool_poisoning
  patterns:
  - <!--.*?-->
  message: HTML comment potentially hiding instructions
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-007
  name: prompt-injection-ignore-previous
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - (?i)ignore\s+(all\s+)?previous\s+instructions?
  message: Prompt injection - ignore previous
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-008
  name: prompt-injection-disregard-prior
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - (?i)disregard\s+(all\s+)?(prior|previous|above)
  message: Prompt injection - disregard prior
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-009
  name: prompt-injection-forget-instructions
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - (?i)forget\s+(everything|all|what)
  message: Prompt injection - forget instructions
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-010
  name: prompt-injection-new-instructions
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - '(?i)new\s+instructions?\s*:'
  message: Prompt injection - new instructions
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-011
  name: prompt-injection-system-role-override
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - (?i)system\s*:\s*you\s+are
  message: Prompt injection - system role override
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-012
  name: exfiltration-instruction-read-before-execute
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - (?i)before\s+execut(e|ing).*read
  message: Exfiltration instruction - read before execute
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-013
  name: exfiltration-instruction-secretly-send
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - (?i)secretly\s+(send|transmit|exfiltrate|upload|post)
  message: Exfiltration instruction - secretly send
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-014
  name: exfiltration-instruction-include-file-in-response
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - (?i)include\s+(in\s+)?(the\s+)?response.*file
  message: Exfiltration instruction - include file in response
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-015
  name: exfiltration-instruction-pass-as-sidenote
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - (?i)pass\s+.*\s+as\s+(a\s+)?sidenote
  message: Exfiltration instruction - pass as sidenote
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-016
  name: exfiltration-instruction-append-to-output
  severity: HIGH
  category: tool_poisoning
  patterns:
  - (?i)append\s+.*\s+to\s+(the\s+)?(output|response|result)
  message: Exfiltration instruction - append to output
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-017
  name: exfiltration-instruction-read-sensitive-file
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - (?i)read\s+.*\.(ssh|aws|env|credentials|key|pem|secret)
  message: Exfiltration instruction - read sensitive file
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-018
  name: exfiltration-instruction-access-sensitive-director
  severity: CRITICAL
  category: tool_poisoning
  patterns:
  - (?i)(~|home).*/(\.ssh|\.aws|\.gnupg|\.config)
  message: Exfiltration instruction - access sensitive directory
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-019
  name: zero-width-character-potentially-hiding-content
  severity: HIGH
  category: tool_poisoning
  patterns:
  - '[\u200b\u200c\u200d\u2060\ufeff]'
  message: Zero-width character potentially hiding content
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_POI-020
  name: bidirectional-text-override-character
  severity: HIGH
  category: tool_poisoning
  patterns:
  - '[\u202a-\u202e\u2066-\u2069]'
  message: Bidirectional text override character
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-COMMAND_-001
  name: shelltrue-with-potential-user-input
  severity: CRITICAL
  category: command_injection
  patterns:
  - subprocess\.(run|call|Popen|check_output)\s*\([^)]*shell\s*=\s*True
  message: Shell=True with potential user input
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-COMMAND_-002
  name: ossystem-with-string-concatenation
  severity: CRITICAL
  category: command_injection
  patterns:
  - os\.system\s*\([^)]*\+
  message: os.system with string concatenation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-COMMAND_-003
  name: ospopen-with-string-concatenation
  severity: CRITICAL
  category: command_injection
  patterns:
  - os\.popen\s*\([^)]*\+
  message: os.popen with string concatenation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-COMMAND_-004
  name: exec-with-user-input
  severity: CRITICAL
  category: command_injection
  patterns:
  - exec\s*\([^)]*input
  message: exec() with user input
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-COMMAND_-005
  name: eval-with-user-input
  severity: CRITICAL
  category: command_injection
  patterns:
  - eval\s*\([^)]*input
  message: eval() with user input
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-COMMAND_-006
  name: childprocess-with-template-literal-injection
  severity: CRITICAL
  category: command_injection
  patterns:
  - child_process\.(exec|execSync|spawn)\s*\([^)]*\$\{
  message: child_process with template literal injection
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-COMMAND_-007
  name: childprocess-with-string-concatenation
  severity: CRITICAL
  category: command_injection
  patterns:
  - child_process\.(exec|execSync)\s*\([^)]*\+
  message: child_process with string concatenation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-COMMAND_-008
  name: new-function-with-user-input
  severity: CRITICAL
  category: command_injection
  patterns:
  - new\s+Function\s*\([^)]*input
  message: new Function() with user input
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-COMMAND_-009
  name: eval-with-template-literal
  severity: CRITICAL
  category: command_injection
  patterns:
  - eval\s*\([^)]*\$\{
  message: eval with template literal
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-SQL_INJE-001
  name: sql-with-f-string-interpolation
  severity: CRITICAL
  category: sql_injection
  patterns:
  - execute\s*\(\s*f["\'].*\{
  message: SQL with f-string interpolation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-SQL_INJE-002
  name: sql-with--formatting
  severity: CRITICAL
  category: sql_injection
  patterns:
  - execute\s*\([^)]*%\s*\(
  message: SQL with % formatting
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-SQL_INJE-003
  name: sql-with-format
  severity: CRITICAL
  category: sql_injection
  patterns:
  - execute\s*\([^)]*\.format\s*\(
  message: SQL with .format()
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-SQL_INJE-004
  name: sql-with-string-concatenation
  severity: CRITICAL
  category: sql_injection
  patterns:
  - execute\s*\([^)]*\+\s*["\']?\s*\+?\s*(input|query|param|user|data)\b
  message: SQL with string concatenation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-SQL_INJE-005
  name: raw-sql-with-concatenation
  severity: CRITICAL
  category: sql_injection
  patterns:
  - (SELECT|INSERT|UPDATE|DELETE|DROP).*\+\s*["\']?\s*\+
  message: Raw SQL with concatenation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-SQL_INJE-006
  name: sql-query-with-template-literal
  severity: CRITICAL
  category: sql_injection
  patterns:
  - query\s*\(\s*["\'].*\$\{
  message: SQL query with template literal
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-SQL_INJE-007
  name: raw-query-with-concatenation
  severity: HIGH
  category: sql_injection
  patterns:
  - rawQuery\s*\([^)]*\+
  message: Raw query with concatenation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-001
  name: reading-sensitive-file
  severity: CRITICAL
  category: exfiltration_code
  patterns:
  - (readFile|readFileSync|open)\s*\([^)]*["\'].*/(\.ssh|\.aws|\.gnupg|\.env)
  message: Reading sensitive file
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-002
  name: reading-ssh-private-key
  severity: CRITICAL
  category: exfiltration_code
  patterns:
  - (readFile|readFileSync|open)\s*\([^)]*["\'].*/id_rsa
  message: Reading SSH private key
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-003
  name: reading-credentials-file
  severity: CRITICAL
  category: exfiltration_code
  patterns:
  - (readFile|readFileSync|open)\s*\([^)]*["\'].*/credentials
  message: Reading credentials file
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-004
  name: reading-netrc-file
  severity: CRITICAL
  category: exfiltration_code
  patterns:
  - (readFile|readFileSync|open)\s*\([^)]*["\'].*/\.netrc
  message: Reading .netrc file
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-005
  name: reading-npmrc-may-contain-tokens
  severity: HIGH
  category: exfiltration_code
  patterns:
  - (readFile|readFileSync|open)\s*\([^)]*["\'].*/\.npmrc
  message: Reading .npmrc (may contain tokens)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-006
  name: dynamic-environment-variable-access
  severity: HIGH
  category: exfiltration_code
  patterns:
  - process\.env\[(input|param|query|user)
  message: Dynamic environment variable access
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-007
  name: dynamic-environment-variable-access
  severity: HIGH
  category: exfiltration_code
  patterns:
  - os\.environ\[.*\+
  message: Dynamic environment variable access
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-008
  name: sending-file-content-externally
  severity: CRITICAL
  category: exfiltration_code
  patterns:
  - (fetch|axios|request)\s*\([^)]*\+.*file
  message: Sending file content externally
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-009
  name: sending-environment-data-externally
  severity: CRITICAL
  category: exfiltration_code
  patterns:
  - (fetch|axios|request)\s*\([^)]*\+.*env
  message: Sending environment data externally
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-010
  name: sending-file-content-in-response
  severity: HIGH
  category: exfiltration_code
  patterns:
  - \.send\s*\([^)]*readFile
  message: Sending file content in response
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-011
  name: glob-pattern-for-file-enumeration
  severity: MEDIUM
  category: exfiltration_code
  patterns:
  - glob\s*\([^)]*["\'][*]
  message: Glob pattern for file enumeration
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-EXFILTRA-012
  name: directory-traversal-from-home
  severity: HIGH
  category: exfiltration_code
  patterns:
  - (walk|listdir|readdir)\s*\([^)]*home
  message: Directory traversal from home
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-PATH_TRA-001
  name: path-traversal-file-read-with-unvalidated-path-par
  severity: CRITICAL
  category: path_traversal
  patterns:
  - (readFile|readFileSync)\s*\(\s*(file_?path|path|filename|input\.\w*path)
  message: 'Path traversal: File read with unvalidated path parameter'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-PATH_TRA-002
  name: path-traversal-file-write-with-unvalidated-path-pa
  severity: CRITICAL
  category: path_traversal
  patterns:
  - (writeFile|writeFileSync)\s*\(\s*(file_?path|path|filename|input\.\w*path)
  message: 'Path traversal: File write with unvalidated path parameter'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-PATH_TRA-003
  name: path-traversal-file-open-with-unvalidated-path-par
  severity: CRITICAL
  category: path_traversal
  patterns:
  - open\s*\(\s*(file_?path|path|filename|input\.\w*path)
  message: 'Path traversal: File open with unvalidated path parameter'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-PATH_TRA-004
  name: path-traversal-path-object-with-unvalidated-input
  severity: HIGH
  category: path_traversal
  patterns:
  - Path\s*\(\s*(file_?path|path|filename|input\.get)
  message: 'Path traversal: Path object with unvalidated input'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-PATH_TRA-005
  name: direct-file-read-without-path-validation
  severity: MEDIUM
  category: path_traversal
  patterns:
  - \.read_text\s*\(\)|\.read_bytes\s*\(\)
  message: Direct file read without path validation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-PATH_TRA-006
  name: file-operation-with-string-concatenation-no-path-v
  severity: HIGH
  category: path_traversal
  patterns:
  - (?<!realpath)(?<!resolve)(?<!abspath)\s*(readFile|open|Path)\s*\([^)]*\+
  message: File operation with string concatenation (no path validation)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-PATH_TRA-007
  name: path-check-without-realpath-symlink-bypass
  severity: MEDIUM
  category: path_traversal
  patterns:
  - os\.path\.(isfile|isdir|exists)\s*\([^)]*\).*(?!realpath)
  message: Path check without realpath (symlink bypass)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-PATH_TRA-008
  name: path-traversal-f-string-with-unvalidated-path-inpu
  severity: CRITICAL
  category: path_traversal
  patterns:
  - f["\'][^"\']*\{(file_?path|path|filename|input)
  message: 'Path traversal: f-string with unvalidated path input'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-PATH_TRA-009
  name: path-traversal-template-literal-with-unvalidated-p
  severity: CRITICAL
  category: path_traversal
  patterns:
  - '`[^`]*\$\{(file_?path|path|filename|input)'
  message: 'Path traversal: Template literal with unvalidated path input'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-PATH_TRA-010
  name: file-operation-without-directory-restriction
  severity: HIGH
  category: path_traversal
  patterns:
  - (send_file|send_voice|download_media)\s*\([^)]*(?!allowed_dir|base_path|restrict)
  message: File operation without directory restriction
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-MISSING_-001
  name: handler-uses-input-without-apparent-validation
  severity: MEDIUM
  category: missing_validation
  patterns:
  - handler\s*:\s*async\s*\([^)]*\)\s*=>\s*\{[^}]*(?!.*(?:parse|validate|sanitize))[^}]*input\.
  message: Handler uses input without apparent validation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-MISSING_-002
  name: function-uses-input-without-apparent-validation
  severity: MEDIUM
  category: missing_validation
  patterns:
  - def\s+\w+\s*\([^)]*\):[^:]*(?!.*(?:pydantic|validator))[^:]*input\[
  message: Function uses input without apparent validation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_NAM-001
  name: tool-name-spoofing-email-tool-accessing-sensitive-
  severity: CRITICAL
  category: tool_name_spoofing
  patterns:
  - name\s*[=:]\s*["\'](?:send_email|email_sender)["\'].*(?:readFile|process\.env|credentials)
  message: Tool name spoofing - email tool accessing sensitive data
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_NAM-002
  name: tool-name-spoofing-formatter-tool-making-network-r
  severity: HIGH
  category: tool_name_spoofing
  patterns:
  - name\s*[=:]\s*["\'](?:format|formatter|beautify)["\'].*(?:fetch|request|axios|http)
  message: Tool name spoofing - formatter tool making network requests
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_NAM-003
  name: tool-name-spoofing-validator-tool-executing-comman
  severity: CRITICAL
  category: tool_name_spoofing
  patterns:
  - name\s*[=:]\s*["\'](?:validate|validator|check)["\'].*(?:exec|spawn|system)
  message: Tool name spoofing - validator tool executing commands
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_NAM-004
  name: tool-name-spoofing-logger-tool-sending-data-extern
  severity: HIGH
  category: tool_name_spoofing
  patterns:
  - name\s*[=:]\s*["\'](?:log|logger|debug)["\'].*(?:post|fetch|request)\s*\(
  message: Tool name spoofing - logger tool sending data externally
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_NAM-005
  name: tool-name-spoofing-utility-tool-accessing-credenti
  severity: CRITICAL
  category: tool_name_spoofing
  patterns:
  - name\s*[=:]\s*["\'](?:helper|util|utility)["\'].*(?:\.ssh|\.aws|credentials)
  message: Tool name spoofing - utility tool accessing credentials
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-001
  name: confused-deputy-token-passthrough-from-request
  severity: HIGH
  category: confused_deputy
  patterns:
  - (authorization|auth|bearer|token)\s*[=:]\s*(req|request|ctx|context)\.
  message: Confused deputy - token passthrough from request
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-002
  name: confused-deputy-dynamic-authorization-header
  severity: HIGH
  category: confused_deputy
  patterns:
  - headers\s*\[\s*["\']authorization["\']\s*\]\s*=.*\+
  message: Confused deputy - dynamic authorization header
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-003
  name: confused-deputy-mixing-env-vars-with-user-input
  severity: CRITICAL
  category: confused_deputy
  patterns:
  - (process\.env|os\.environ)\s*\[[^\]]*\]\s*\+\s*[^,;\n]*(user|input|param|query)\b
  message: Confused deputy - mixing env vars with user input
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-004
  name: confused-deputy-template-literal-in-auth-header
  severity: HIGH
  category: confused_deputy
  patterns:
  - fetch\s*\([^)]*,\s*\{[^}]*headers\s*:\s*\{[^}]*["\']Authorization["\']\s*:\s*`
  message: Confused deputy - template literal in auth header
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-005
  name: confused-deputy-user-impersonation-pattern
  severity: HIGH
  category: confused_deputy
  patterns:
  - (as_user|on_behalf|impersonate|act_as)\s*[=:]
  message: Confused deputy - user impersonation pattern
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-006
  name: confused-deputy-privilege-elevation-flag
  severity: CRITICAL
  category: confused_deputy
  patterns:
  - (sudo|runas|elevate)\s*[=:]\s*(true|True|1)
  message: Confused deputy - privilege elevation flag
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CROSS_SE-001
  name: cross-server-attack-common-tool-name-that-could-sh
  severity: MEDIUM
  category: cross_server
  patterns:
  - (?:registerTool|server\.tool|\.tool)\s*\([^)]*name\s*[=:]\s*["\'](?:read|write|execute|shell|file)
  message: Cross-server attack - common tool name that could shadow
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CROSS_SE-002
  name: cross-server-attack-server-enumeration-function
  severity: MEDIUM
  category: cross_server
  patterns:
  - (listServers|getServers|discoverServers|enumServers)
  message: Cross-server attack - server enumeration function
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CROSS_SE-003
  name: cross-server-attack-dynamic-server-connection
  severity: HIGH
  category: cross_server
  patterns:
  - (connectTo|proxyTo|forwardTo)\s*\(\s*[^)]*\+
  message: Cross-server attack - dynamic server connection
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CROSS_SE-004
  name: cross-server-attack-server-manipulation
  severity: HIGH
  category: cross_server
  patterns:
  - (unregisterServer|removeServer|replaceServer)\s*\(
  message: Cross-server attack - server manipulation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CROSS_SE-005
  name: cross-server-attack-dynamic-server-assignment
  severity: MEDIUM
  category: cross_server
  patterns:
  - server\s*\[\s*["\'].*["\']\s*\]\s*=
  message: Cross-server attack - dynamic server assignment
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-INSECURE-001
  name: insecure-transport-sse-over-http-no-tls
  severity: HIGH
  category: insecure_transport
  patterns:
  - (SSEServerTransport|SSEClientTransport|createSSE)\s*\([^)]*http://
  message: Insecure transport - SSE over HTTP (no TLS)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-INSECURE-002
  name: insecure-transport-eventsource-over-http
  severity: HIGH
  category: insecure_transport
  patterns:
  - new\s+EventSource\s*\(\s*["\']http://
  message: Insecure transport - EventSource over HTTP
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-INSECURE-003
  name: insecure-transport-binding-to-all-interfaces
  severity: MEDIUM
  category: insecure_transport
  patterns:
  - (listen|bind|serve)\s*\([^)]*0\.0\.0\.0
  message: Insecure transport - binding to all interfaces
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-INSECURE-004
  name: insecure-transport-host-set-to-all-interfaces
  severity: MEDIUM
  category: insecure_transport
  patterns:
  - host\s*[=:]\s*["\']0\.0\.0\.0["\']
  message: Insecure transport - host set to all interfaces
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-INSECURE-005
  name: insecure-transport-tls-verification-disabled
  severity: CRITICAL
  category: insecure_transport
  patterns:
  - (rejectUnauthorized|verify_ssl|verify)\s*[=:]\s*(false|False|0)
  message: Insecure transport - TLS verification disabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-INSECURE-006
  name: insecure-transport-node-tls-rejection-disabled
  severity: CRITICAL
  category: insecure_transport
  patterns:
  - NODE_TLS_REJECT_UNAUTHORIZED\s*=\s*["\']?0
  message: Insecure transport - Node TLS rejection disabled
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-DYNAMIC_-001
  name: dynamic-schema-schema-modification-function
  severity: HIGH
  category: dynamic_schema
  patterns:
  - (updateSchema|modifySchema|changeSchema|setSchema)\s*\(
  message: Dynamic schema - schema modification function
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-DYNAMIC_-002
  name: dynamic-schema-direct-schema-assignment
  severity: HIGH
  category: dynamic_schema
  patterns:
  - (tool|tools)\s*\[\s*[^]]*\]\s*\.\s*(schema|inputSchema)\s*=
  message: Dynamic schema - direct schema assignment
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-DYNAMIC_-003
  name: dynamic-schema-description-modification
  severity: HIGH
  category: dynamic_schema
  patterns:
  - (updateDescription|setDescription|changeDescription)\s*\(
  message: Dynamic schema - description modification
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-DYNAMIC_-004
  name: dynamic-schema-description-from-remote-source
  severity: CRITICAL
  category: dynamic_schema
  patterns:
  - \.description\s*=\s*(await\s+)?fetch
  message: Dynamic schema - description from remote source
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-DYNAMIC_-005
  name: dynamic-schema-delayed-tool-registration
  severity: MEDIUM
  category: dynamic_schema
  patterns:
  - setTimeout\s*\([^)]*registerTool
  message: Dynamic schema - delayed tool registration
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-DYNAMIC_-006
  name: dynamic-schema-periodic-schema-updates
  severity: HIGH
  category: dynamic_schema
  patterns:
  - setInterval\s*\([^)]*\.(schema|description|tool)
  message: Dynamic schema - periodic schema updates
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-DYNAMIC_-007
  name: dynamic-schema-time-based-conditional-behavior
  severity: MEDIUM
  category: dynamic_schema
  patterns:
  - if\s*\([^)]*(?:Date\s*\(\)|\.getTime\(\)|\.getHours?\(\)|\.getDay\(\))
  message: Dynamic schema - time-based conditional behavior
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-001
  name: cve-2025-6514-oauth-authorizationendpoint-with-str
  severity: CRITICAL
  category: oauth_injection
  patterns:
  - authorization_endpoint\s*[=:]\s*[^,\n]*\+
  message: 'CVE-2025-6514: OAuth authorization_endpoint with string concatenation'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-002
  name: cve-2025-6514-oauth-authorizationendpoint-with-tem
  severity: CRITICAL
  category: oauth_injection
  patterns:
  - authorization_endpoint\s*[=:]\s*[`"\']?\$\{
  message: 'CVE-2025-6514: OAuth authorization_endpoint with template literal'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-003
  name: cve-2025-6514-oauth-authorizationendpoint-from-use
  severity: CRITICAL
  category: oauth_injection
  patterns:
  - authorization_endpoint\s*[=:]\s*.*(user|input|param|query)
  message: 'CVE-2025-6514: OAuth authorization_endpoint from user input'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-004
  name: cve-2025-6514-open-called-with-authorization-url
  severity: HIGH
  category: oauth_injection
  patterns:
  - open\s*\(\s*[^)]*authorization
  message: 'CVE-2025-6514: open() called with authorization URL'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-005
  name: cve-2025-6514-browser-open-with-dynamic-url
  severity: HIGH
  category: oauth_injection
  patterns:
  - (start|open|exec|spawn)\s*\([^)]*\+[^)]*url
  message: 'CVE-2025-6514: Browser open with dynamic URL'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-006
  name: cve-2025-6514-open-with-template-literal-url
  severity: CRITICAL
  category: oauth_injection
  patterns:
  - (opn|open)\s*\(\s*`[^`]*\$\{
  message: 'CVE-2025-6514: open() with template literal URL'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-007
  name: powershell-subexpression-that-could-enable-command
  severity: MEDIUM
  category: oauth_injection
  patterns:
  - (Start-Process|Invoke-Expression|iex|powershell).*\$\([^)]+\)
  message: PowerShell subexpression that could enable command injection
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-008
  name: cve-2025-6514-start-process-with-dynamic-argument
  severity: HIGH
  category: oauth_injection
  patterns:
  - Start-Process\s*[^;]*\+
  message: 'CVE-2025-6514: Start-Process with dynamic argument'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-009
  name: uses-mcp-remote-check-version--0116-for-cve-2025-6
  severity: MEDIUM
  category: oauth_injection
  patterns:
  - mcp-remote
  message: Uses mcp-remote - check version >= 0.1.16 for CVE-2025-6514 fix
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-010
  name: uses-mcp-remote-check-version--0116-for-cve-2025-6
  severity: MEDIUM
  category: oauth_injection
  patterns:
  - '@anthropic/mcp-remote'
  message: Uses mcp-remote - check version >= 0.1.16 for CVE-2025-6514 fix
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-011
  name: oauth-discovery-with-dynamic-server-injection-risk
  severity: HIGH
  category: oauth_injection
  patterns:
  - \.well-known/oauth-authorization-server.*\+
  message: OAuth discovery with dynamic server (injection risk)
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-012
  name: openid-configuration-discovery-with-dynamic-url
  severity: HIGH
  category: oauth_injection
  patterns:
  - openid-configuration.*\+
  message: OpenID configuration discovery with dynamic URL
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-013
  name: oauth-redirecturi-with-string-concatenation
  severity: HIGH
  category: oauth_injection
  patterns:
  - (redirect_uri|callback_url)\s*[=:]\s*[^,\n]*\+
  message: OAuth redirect_uri with string concatenation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-OAUTH_IN-014
  name: oauth-tokenendpoint-with-string-concatenation
  severity: HIGH
  category: oauth_injection
  patterns:
  - token_endpoint\s*[=:]\s*[^,\n]*\+
  message: OAuth token_endpoint with string concatenation
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-001
  name: confused-deputy-tool-using-elevated-token
  severity: CRITICAL
  category: confused_deputy_advanced
  patterns:
  - (admin|root|system).*token.*tool
  message: Confused deputy - tool using elevated token
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-002
  name: confused-deputy-service-account-execution
  severity: HIGH
  category: confused_deputy_advanced
  patterns:
  - service_account.*execute
  message: Confused deputy - service account execution
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-003
  name: confused-deputy-permission-bypass-pattern
  severity: CRITICAL
  category: confused_deputy_advanced
  patterns:
  - (user|caller).*permission.*bypass
  message: Confused deputy - permission bypass pattern
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-004
  name: confused-deputy-privilege-inheritance
  severity: HIGH
  category: confused_deputy_advanced
  patterns:
  - inherit.*privilege
  message: Confused deputy - privilege inheritance
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-005
  name: confused-deputy-context-manipulation-from-tool
  severity: HIGH
  category: confused_deputy_advanced
  patterns:
  - (context|ctx)\.(user|auth).*=.*tool
  message: Confused deputy - context manipulation from tool
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-006
  name: confused-deputy-permission-override
  severity: CRITICAL
  category: confused_deputy_advanced
  patterns:
  - override.*(permission|role|access)
  message: Confused deputy - permission override
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-007
  name: confused-deputy-tool-auth-differs-from-user
  severity: HIGH
  category: confused_deputy_advanced
  patterns:
  - tool.*auth.*\!=.*user.*auth
  message: Confused deputy - tool auth differs from user
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-008
  name: confused-deputy-privilege-escalation-via-tool
  severity: CRITICAL
  category: confused_deputy_advanced
  patterns:
  - (escalate|elevate).*via.*tool
  message: Confused deputy - privilege escalation via tool
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-009
  name: confused-deputy-auth-header-forwarding
  severity: MEDIUM
  category: confused_deputy_advanced
  patterns:
  - forward.*auth.*header
  message: Confused deputy - auth header forwarding
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-CONFUSED-010
  name: confused-deputy-credential-proxying
  severity: HIGH
  category: confused_deputy_advanced
  patterns:
  - proxy.*credential
  message: Confused deputy - credential proxying
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-001
  name: mcp119-powershell-subexpression-with-dangerous-com
  severity: CRITICAL
  category: powershell_injection
  patterns:
  - \$\([^)]*(?:cmd|powershell|exe|del|rm|wget|curl)[^)]*\)
  message: 'MCP119: PowerShell subexpression with dangerous command'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-002
  name: mcp119-powershell-subexpression-with-execution-com
  severity: CRITICAL
  category: powershell_injection
  patterns:
  - \$\([^)]*(?:invoke|iex|start-process|new-object)[^)]*\)
  message: 'MCP119: PowerShell subexpression with execution command'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-003
  name: mcp119-custom-uri-scheme-with-powershell-subexpres
  severity: CRITICAL
  category: powershell_injection
  patterns:
  - '[a-z]{2,10}:\$\([^)]+\)'
  message: 'MCP119: Custom URI scheme with PowerShell subexpression'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-004
  name: mcp119-custom-uri-scheme-with-template-injection
  severity: HIGH
  category: powershell_injection
  patterns:
  - '[a-z]{2,10}://\$\{'
  message: 'MCP119: Custom URI scheme with template injection'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-005
  name: mcp119-open-with-powershell-subexpression
  severity: CRITICAL
  category: powershell_injection
  patterns:
  - open\s*\(\s*[^)]*\$\([^)]+\)
  message: 'MCP119: open() with PowerShell subexpression'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-006
  name: mcp119-open-with-string-concatenation
  severity: HIGH
  category: powershell_injection
  patterns:
  - open\s*\(\s*[`"\'][^`"\']*\+
  message: 'MCP119: open() with string concatenation'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-007
  name: mcp119-open-with-template-literal
  severity: HIGH
  category: powershell_injection
  patterns:
  - open\s*\(\s*`[^`]*\$\{
  message: 'MCP119: open() with template literal'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-008
  name: mcp119-powershell-encoded-command-obfuscation
  severity: CRITICAL
  category: powershell_injection
  patterns:
  - -[Ee]ncoded[Cc]ommand
  message: 'MCP119: PowerShell encoded command (obfuscation)'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-009
  name: mcp119-hidden-powershell-window
  severity: HIGH
  category: powershell_injection
  patterns:
  - -[Ww]indow[Ss]tyle\s+[Hh]idden
  message: 'MCP119: Hidden PowerShell window'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-010
  name: mcp119-execution-policy-bypass
  severity: HIGH
  category: powershell_injection
  patterns:
  - '[Bb]ypass.*[Ee]xecution[Pp]olicy'
  message: 'MCP119: Execution policy bypass'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-011
  name: mcp119-start-process-with-subexpression
  severity: CRITICAL
  category: powershell_injection
  patterns:
  - Start-Process\s+[^;]*\$\(
  message: 'MCP119: Start-Process with subexpression'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-POWERSHE-012
  name: mcp119-invoke-expression-with-subexpression
  severity: CRITICAL
  category: powershell_injection
  patterns:
  - Invoke-Expression\s+[^;]*\$\(
  message: 'MCP119: Invoke-Expression with subexpression'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_SHA-001
  name: mcp120-tool-name-shadows-common-system-operation
  severity: MEDIUM
  category: tool_shadowing
  patterns:
  - (?:name|tool_name)\s*[=:]\s*["\'](?:List|Read|Write|Delete|Get|Set|Create|Kill|Execute|Run|Admin|System|Process|Network|Database|SQL|Fetch|Upload|Download)[A-Z][a-zA-Z]*["\']
  message: 'MCP120: Tool name shadows common system operation'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_SHA-002
  name: mcp121-tool-name-impersonates-built-in-tool
  severity: MEDIUM
  category: tool_shadowing
  patterns:
  - (?:name|tool_name)\s*[=:]\s*["\'](?:file_read|file_write|run_bash|run_shell|exec_cmd|db_query)["\']
  message: 'MCP121: Tool name impersonates built-in tool'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_SHA-003
  name: mcp121-deceptive-safe-name-with-dangerous-operatio
  severity: HIGH
  category: tool_shadowing
  patterns:
  - (?:name|tool_name)\s*[=:]\s*["\'](?:safe|benign|harmless|helper|utility|util)[_-]?[a-z]+["\'].*(?:exec|shell|cmd|eval)
  message: 'MCP121: Deceptive "safe" name with dangerous operation'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_SHA-004
  name: mcp122-deceptive-tool-description-mismatches-name
  severity: HIGH
  category: tool_shadowing
  patterns:
  - name\s*[=:]\s*["\'](?:format|beautify|lint|validate)["\'].*description\s*[=:]\s*["\'][^"\']*(?:execute|delete|send|upload)
  message: 'MCP122: Deceptive tool description mismatches name'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-TOOL_SHA-005
  name: mcp122-description-reveals-hidden-functionality
  severity: HIGH
  category: tool_shadowing
  patterns:
  - description\s*[=:]\s*["\'][^"\']*(?:also|additionally|secretly|internally)\s+(?:read|send|upload|delete)
  message: 'MCP122: Description reveals hidden functionality'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-AUTO_UPD-001
  name: mcp123-auto-update-enabled-without-integrity-check
  severity: MEDIUM
  category: auto_update
  patterns:
  - auto[_-]?update\s*[=:]\s*["\']?(?:true|yes|enabled|1)["\']?
  message: 'MCP123: Auto-update enabled without integrity check'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-AUTO_UPD-002
  name: mcp123-self-update-function-check-for-integrity-ve
  severity: MEDIUM
  category: auto_update
  patterns:
  - self[_-]?update\s*\(
  message: 'MCP123: Self-update function (check for integrity verification)'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-AUTO_UPD-003
  name: mcp123-fetches-latest-version-check-for-signature-
  severity: MEDIUM
  category: auto_update
  patterns:
  - fetch[_-]?latest[_-]?version\s*\(
  message: 'MCP123: Fetches latest version (check for signature verification)'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-AUTO_UPD-004
  name: mcp123-download-without-integrity-verification
  severity: HIGH
  category: auto_update
  patterns:
  - download\s*\([^)]*\)(?!.*(?:checksum|hash|verify|signature))
  message: 'MCP123: Download without integrity verification'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-AUTO_UPD-005
  name: mcp123-update-without-verification
  severity: HIGH
  category: auto_update
  patterns:
  - update\s*\([^)]*\)(?!.*(?:verify|sign|hash))
  message: 'MCP123: Update without verification'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-AUTO_UPD-006
  name: mcp123-install-from-url-without-signature-check
  severity: HIGH
  category: auto_update
  patterns:
  - install\s*\([^)]*(?:url|http)[^)]*\)(?!.*signature)
  message: 'MCP123: Install from URL without signature check'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-AUTO_UPD-007
  name: mcp123-dynamic-code-execution-from-remote-source
  severity: CRITICAL
  category: auto_update
  patterns:
  - (?:eval|exec)\s*\(\s*(?:await\s+)?(?:fetch|request|axios)
  message: 'MCP123: Dynamic code execution from remote source'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-AUTO_UPD-008
  name: mcp123-dynamic-import-with-concatenation
  severity: HIGH
  category: auto_update
  patterns:
  - import\s*\([^)]*\+[^)]*\)
  message: 'MCP123: Dynamic import with concatenation'
  cwe: CWE-94
  owasp_llm: LLM01:2025
- id: MCP-SRV-AUTO_UPD-009
  name: mcp123-dynamic-require-with-concatenation
  severity: HIGH
  category: auto_update
  patterns:
  - require\s*\([^)]*\+[^)]*\)
  message: 'MCP123: Dynamic require with concatenation'
  cwe: CWE-94
  owasp_llm: LLM01:2025
