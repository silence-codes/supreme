(()=>{"use strict";var e={718(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeLensProvider=void 0;const s=n(398);t.CodeLensProvider=class{constructor(){this._onDidChangeCodeLenses=new s.EventEmitter,this.onDidChangeCodeLenses=this._onDidChangeCodeLenses.event,this.issuesMap=new Map}updateIssues(e){this.issuesMap.clear(),e.forEach(e=>{const t=s.Uri.file(e.Target).toString();this.issuesMap.set(t,e.Issues)}),this._onDidChangeCodeLenses.fire()}provideCodeLenses(e,t){const n=e.uri.toString(),a=this.issuesMap.get(n);if(!a||0===a.length)return[];const o=[],r=new Map;return a.forEach(e=>{const t=(e.StartLine||1)-1;r.has(t)||r.set(t,[]),r.get(t)?.push(e)}),r.forEach((e,t)=>{const n=new s.Range(t,0,t,0),a=e.length,r={title:`${e.some(e=>"CRITICAL"===e.Severity||"HIGH"===e.Severity)?"ðŸ”´":"Vk"} ${a} Supreme Issue${a>1?"s":""}: ${e[0].Name}`,tooltip:e.map(e=>`[${e.Severity}] ${e.Name}: ${e.Description}`).join("\n"),command:"",arguments:[]};o.push(new s.CodeLens(n,r))}),o}}},28(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getExcludePaths=t.getPythonPath=t.getGlobalPythonPath=t.getGlobalVenvPath=t.CONFIG=void 0;const s=n(398),a=n(896),o=n(928),r=n(857);function i(){return o.join(r.homedir(),".supreme2l","venv")}function c(){const e=i(),t="win32"===process.platform;return o.join(e,t?"Scripts":"bin",t?"python.exe":"python")}t.CONFIG={COMMANDS:{START_SCAN:"supreme2l.startScan",STOP_SCAN:"supreme2l.stopScan",EXPORT_REPORT:"supreme2l.exportReport",INSTALL_TOOLS:"supreme2l.installTools"},VIEWS:{DASHBOARD:"supreme2l-dashboard",RESULTS:"supreme2l-results"},SETTINGS:{PYTHON_PATH:"supreme2l.pythonPath",EXCLUDE_PATHS:"supreme2l.excludePaths",SEVERITY_FILTER:"supreme2l.severityFilter"}},t.getGlobalVenvPath=i,t.getGlobalPythonPath=c,t.getPythonPath=function(){const e=s.workspace.getConfiguration().get(t.CONFIG.SETTINGS.PYTHON_PATH);if(e)return e;const n=c();if(a.existsSync(n))return n;const r=s.workspace.getConfiguration("python").get("defaultInterpreterPath");if(r&&"python"!==r&&a.existsSync(r))return r;const i=s.workspace.workspaceFolders;if(i&&i.length>0){const e=i[0].uri.fsPath,t=[o.join(e,".venv","bin","python"),o.join(e,".venv","Scripts","python.exe"),o.join(e,"venv","bin","python"),o.join(e,"venv","Scripts","python.exe")];for(const e of t)if(a.existsSync(e))return e}return"python3"},t.getExcludePaths=function(){return s.workspace.getConfiguration().get(t.CONFIG.SETTINGS.EXCLUDE_PATHS)||[]}},365(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.PythonBridge=void 0;const s=n(398),a=n(317),o=n(896),r=n(928),i=n(857),c=n(28);class l{static setExtensionPath(e){this.extensionPath=e}static async checkInstallation(){const e=(0,c.getPythonPath)();return new Promise(t=>{const n=a.spawn(e,["-m","supreme2l","--version"]);let s="",o="";n.stdout?.on("data",e=>{s+=e.toString()}),n.stderr?.on("data",e=>{o+=e.toString()}),n.on("error",n=>{this.outputChannel.appendLine(`Installation check failed with ${e}: ${n.message}`),t(!1)}),n.on("close",n=>{if(0===n)return this.outputChannel.appendLine(`Supreme 2 Light found: ${s.trim()}`),void t(!0);const a=o.trim()||s.trim();this.outputChannel.appendLine(`Installation check failed with ${e} (code ${n}). ${a}`),t(!1)})})}static async installTools(){const e=s.workspace.workspaceFolders?.[0]?.uri.fsPath,t=s.window.activeTextEditor?.document.uri.fsPath;let n=e||(t?r.dirname(t):"");if(!n){const e=await s.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,openLabel:"Select project folder for install"});if(!e||0===e.length)return void s.window.showWarningMessage("Install canceled: no target folder selected.");n=e[0].fsPath}const a=s.window.createTerminal({name:"Supreme 2 Light Installer",cwd:n});a.show();const i=(e,t)=>{const n=t.map(e=>(e=>`"${e.replace(/"/g,'\\"')}"`)(e)).join(" ");"win32"===process.platform?a.sendText(`cmd /d /c ""${e}" ${n}"`):a.sendText(`"${e}" ${n}`)},l=(await this.checkInstallation(),(0,c.getGlobalPythonPath)()),d=this.extensionPath?r.join(this.extensionPath,"resources","supreme2l-1.0.9-py3-none-any.whl"):"",p=(0,c.getGlobalVenvPath)();if(a.sendText(`echo "Setting up/Updating Supreme 2 Light environment at ${p}..."`),a.sendText(`echo "Project target: ${n}"`),!o.existsSync(l)){let e="python3";"win32"===process.platform&&(e="python"),a.sendText(`${e} -m venv "${p}"`)}d&&o.existsSync(d)?(a.sendText('echo "Installing Supreme 2 Light v1.0.9 from bundle..."'),i(l,["-m","pip","install","--force-reinstall",d])):(a.sendText(`echo "Warning: Bundled wheel not found at ${d}. Trying PyPI..."`),i(l,["-m","pip","install","--upgrade","supreme2l"])),i(l,["-m","supreme2l","install","--smart","--yes","--target",n]),a.sendText('echo "Installation complete! You can now Scan."')}static async runScan(e,t){if(this.childProcess)throw new Error("Scan already running");const n=(0,c.getPythonPath)(),s=o.mkdtempSync(r.join(i.tmpdir(),"s2l-scan-")),l=["-m","supreme2l","scan",e,"--format","json","--output",s,"--no-install"];let d=process.cwd();try{if(o.existsSync(e)){const t=o.statSync(e);d=t.isDirectory()?e:r.dirname(e)}}catch{}return this.outputChannel.appendLine(`Starting scan: ${n} ${l.join(" ")}`),this.outputChannel.appendLine(`Scan CWD: ${d}`),t&&t("Initializing scan..."),new Promise((i,c)=>{this.childProcess=a.spawn(n,l,{cwd:d}),this.childProcess.stdout?.on("data",e=>{const n=e.toString();this.outputChannel.append(n),t&&(n.includes("Scanning")&&t("Scanning files..."),n.includes("Analyzing")&&t("Analyzing results..."))}),this.childProcess.stderr?.on("data",e=>{this.outputChannel.append(`ERR: ${e.toString()}`)}),this.childProcess.on("close",t=>{if(this.childProcess=null,0===t)try{const t=o.readdirSync(s).filter(e=>e.endsWith(".json")),n=t.filter(e=>e.startsWith("supreme2l-scan-")).sort((e,t)=>e.localeCompare(t)).reverse(),a=t.filter(e=>"scan_history.json"!==e),l=[...n,...a.filter(e=>!n.includes(e))];let d=null;for(const e of l){const t=r.join(s,e);try{const e=o.readFileSync(t,"utf-8"),n=JSON.parse(e);if(!Array.isArray(n)&&n&&Array.isArray(n.findings)){d=n;break}}catch{}}if(d){const t=this.parseResults(d,e);try{o.rmSync(s,{recursive:!0,force:!0})}catch(e){console.error(`Failed to clean up temp files: ${e}`)}i(t)}else c(new Error("No JSON report generated in output directory"))}catch(e){c(new Error(`Failed to parse results: ${e}`))}else c(new Error(`Scan failed with code ${t}`))})})}static stopScan(){this.childProcess&&(this.childProcess.kill(),this.childProcess=null,this.outputChannel.appendLine("Scan stopped by user."))}static parseResults(e,t){const n=e.findings||[],s=new Map;for(const e of n){const t=e.file||"unknown",n="number"==typeof e.cwe_id?`CWE-${e.cwe_id}`:"string"==typeof e.cwe&&e.cwe?e.cwe:void 0,a={ID:e.rule_id||n||"UNKNOWN",Name:e.message||e.issue||"Unknown Issue",Severity:(e.severity||"INFO").toUpperCase(),Description:e.description||e.message||e.issue||"No description available",Type:e.tool||e.scanner||"S2L",StartLine:e.line,CodeSnippet:e.code,CWE:n,CWELink:e.cwe_link};s.has(t)||s.set(t,[]),s.get(t)?.push(a)}const a=[];return s.forEach((e,t)=>{a.push({Target:t,Issues:e})}),a}}t.PythonBridge=l,l.childProcess=null,l.outputChannel=s.window.createOutputChannel("Supreme 2 Light"),l.extensionPath=""},80(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.generateReportHtml=void 0;const s=n(398);function a(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}t.generateReportHtml=function(e,t){let n="",o=0;return e.forEach(e=>{e.Issues&&0!==e.Issues.length&&e.Issues.forEach(t=>{o++;const r=e.Target,i=`command:vscode.open?${encodeURIComponent(JSON.stringify(s.Uri.file(r)))}`,c=t.CodeSnippet?t.CodeSnippet.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):null,l=c?`<div class="code-block">${c}</div>`:`<div style="font-style:italic; color:#666; margin: 10px 0; font-size:0.9em;">No code snippet available (Line ${t.StartLine||"unknown"})</div>`,d=t.CWE?`<div class="meta-item"><span class="meta-label">CWE</span><a href="${t.CWELink||"#"}" class="meta-value">${t.CWE}</a></div>`:"";n+=`\n                <div class="card severity-${t.Severity}">\n                    <div class="card-header">\n                        <div class="issue-main">\n                            <div class="badges">\n                                <span class="badge badge-type">${a(t.Type)}</span>\n                                <span class="badge severity-badge ${t.Severity}">${t.Severity}</span>\n                            </div>\n                            <div class="issue-title">${a(t.Name)}</div>\n                        </div>\n                    </div>\n                    \n                    <div class="description">${a(t.Description||"No description available.")}</div>\n                    \n                    ${l}\n\n                    <div class="meta-grid">\n                        <div class="meta-item">\n                            <span class="meta-label">Identifier</span>\n                            <span class="meta-value">${a(t.ID)}</span>\n                        </div>\n                        <div class="meta-item">\n                            <span class="meta-label">Location</span>\n                            <a href="${i}" class="meta-value" title="Open File">${r}${t.StartLine?`:${t.StartLine}`:""}</a>\n                        </div>\n                        ${d}\n                    </div>\n                </div>\n            `})}),0===o&&(n='\n            <div style="text-align:center; margin-top: 100px; opacity: 0.7;">\n                <h2 style="color: #2ecc71; margin-top: 20px;">All systems operational</h2>\n                <p>No vulnerabilities found.</p>\n            </div>'),`\n        <!DOCTYPE html>\n        <html lang="en">\n        <head>\n            <meta charset="UTF-8">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <title>Supreme Report</title>\n            <style>\n        :root {\n            --glass-bg: rgba(30, 30, 30, 0.6);\n            --glass-border: rgba(255, 255, 255, 0.1);\n            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);\n            --primary-color: #9b59b6;\n            --text-color: #e0e0e0;\n            --code-bg: #0d0d0d;\n        }\n\n        * {\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;\n            background-color: #050505;\n            background-image: \n                radial-gradient(circle at 15% 50%, rgba(155, 89, 182, 0.08), transparent 25%), \n                radial-gradient(circle at 85% 30%, rgba(52, 152, 219, 0.08), transparent 25%);\n            background-attachment: fixed;\n            color: var(--text-color);\n            padding: 40px 20px;\n            margin: 0;\n            line-height: 1.6;\n        }\n\n        .container {\n            max-width: 1000px;\n            margin: 0 auto;\n        }\n\n        h1 {\n            font-size: 2.5rem;\n            font-weight: 200;\n            color: #fff;\n            margin-bottom: 0.5rem;\n            letter-spacing: -1px;\n        }\n\n        .subtitle {\n            color: #888;\n            margin-bottom: 3rem;\n            font-size: 1.1rem;\n            font-weight: 300;\n            display: flex;\n            gap: 15px;\n            align-items: center;\n        }\n\n        .card {\n            background: var(--glass-bg);\n            border-radius: 12px;\n            box-shadow: var(--glass-shadow);\n            backdrop-filter: blur(8px);\n            -webkit-backdrop-filter: blur(8px);\n            border: 1px solid var(--glass-border);\n            margin-bottom: 2rem;\n            padding: 1.5rem;\n            overflow: hidden;\n            position: relative;\n        }\n        \n        .card::before {\n            content: '';\n            position: absolute;\n            top: 0; left: 0; bottom: 0; width: 4px;\n            background: #555; \n        }\n        .card.severity-CRITICAL::before { background: #ff5252; box-shadow: 0 0 10px #ff5252; }\n        .card.severity-HIGH::before { background: #ffb142; }\n        .card.severity-MEDIUM::before { background: #ffda79; }\n        .card.severity-LOW::before { background: #34ace0; }\n        .card.severity-INFO::before { background: #636e72; }\n\n        .card-header {\n            display: flex;\n            flex-wrap: wrap;\n            justify-content: space-between;\n            align-items: flex-start;\n            gap: 15px;\n            margin-bottom: 1rem;\n        }\n\n        .issue-main {\n            flex: 1;\n            min-width: 250px;\n        }\n\n        .issue-title {\n            font-size: 1.4rem;\n            font-weight: 600;\n            color: #fff;\n            margin-top: 8px;\n            word-break: break-word;\n            line-height: 1.3;\n        }\n\n        .badges {\n            display: flex;\n            gap: 8px;\n            flex-wrap: wrap;\n        }\n\n        .badge {\n            padding: 4px 10px;\n            border-radius: 4px;\n            font-size: 0.75rem;\n            font-weight: 700;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n            white-space: nowrap;\n        }\n\n        .badge-type { background: rgba(255, 255, 255, 0.1); color: #aaa; }\n\n        .severity-badge {\n            background: #333;\n            color: #fff;\n        }\n        .severity-badge.CRITICAL { color: #ff5252; background: rgba(255, 82, 82, 0.15); }\n        .severity-badge.HIGH { color: #ffb142; background: rgba(255, 177, 66, 0.15); }\n        .severity-badge.MEDIUM { color: #ffda79; background: rgba(255, 218, 121, 0.15); }\n        .severity-badge.LOW { color: #34ace0; background: rgba(52, 172, 224, 0.15); }\n        .severity-badge.INFO { color: #636e72; background: rgba(99, 110, 114, 0.15); }\n\n        .description {\n            color: #ccc;\n            margin-bottom: 1.5rem;\n            font-size: 1rem;\n            word-wrap: break-word;\n        }\n\n        .code-block {\n            background: var(--code-bg);\n            padding: 1rem;\n            border-radius: 6px;\n            border: 1px solid #222;\n            font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;\n            font-size: 0.85rem;\n            overflow-x: auto;\n            color: #d4d4d4;\n            margin: 1.5rem 0;\n            white-space: pre;\n            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);\n        }\n\n        .meta-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));\n            gap: 20px;\n            padding-top: 1.5rem;\n            border-top: 1px solid rgba(255, 255, 255, 0.05);\n        }\n\n        .meta-item {\n            display: flex;\n            flex-direction: column;\n            gap: 5px;\n        }\n\n        .meta-label {\n            font-size: 0.7rem;\n            text-transform: uppercase;\n            color: #666;\n            font-weight: 600;\n            letter-spacing: 1px;\n        }\n\n        .meta-value {\n            font-size: 0.9rem;\n            color: #eee;\n            word-break: break-all;\n            font-family: monospace;\n        }\n\n        a.meta-value {\n            color: #a29bfe;\n            text-decoration: none;\n            transition: opacity 0.2s;\n        }\n        a.meta-value:hover {\n            opacity: 0.8;\n            text-decoration: underline;\n        }\n    </style>\n        </head>\n        <body>\n            <div class="container">\n                <h1>Supreme Report</h1>\n                <div class="subtitle">\n                    <span>${(new Date).toLocaleString()}</span>\n                    <span>&bull;</span>\n                    <span>${o} issues detected</span>\n                </div>\n                ${n}\n            </div>\n        </body>\n        </html>\n    `}},33(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.SidebarProvider=void 0;const s=n(398),a=n(928),o=n(896);t.SidebarProvider=class{constructor(e){this._extensionUri=e,this.pendingMessages=[],this.isScanning=!1}resolveWebviewView(e,t,n){this._view=e,e.webview.options={enableScripts:!0,localResourceRoots:[this._extensionUri]},e.webview.html=this._getHtmlForWebview(e.webview),e.webview.onDidReceiveMessage(e=>{switch(e.type){case"startScan":s.commands.executeCommand("supreme2l.startScan");break;case"stopScan":s.commands.executeCommand("supreme2l.stopScan");break;case"export":s.commands.executeCommand("supreme2l.exportReport");break;case"installTools":s.commands.executeCommand("supreme2l.installTools");break;case"ready":this.sendInitialState()}}),this.pendingMessages.forEach(t=>e.webview.postMessage(t)),this.pendingMessages=[]}sendInitialState(){this.postMessage({type:"state",isScanning:this.isScanning})}postMessage(e){this._view?this._view.webview.postMessage(e):this.pendingMessages.push(e)}setScanningState(e){this.isScanning=e,this.postMessage({type:"state",isScanning:this.isScanning})}updateStats(e,t,n,s,a){let o=100-10*t-5*n-2*s-1*a;o<0&&(o=0);const r=Math.round(o);this.postMessage({type:"stats",total:e,critical:t,high:n,score:r})}setHistoryData(e){const t=e.slice(0,7).reverse();if(t.length<2)return void this.postMessage({type:"chart",svg:""});const n=Math.max(...t.map(e=>e.summary?e.summary.total:0))||1,s=t.map((e,s)=>`${s/(t.length-1)*200},${60-(e.summary?e.summary.total:0)/n*60}`).join(" "),a=`<svg width="100%" height="100%" viewBox="0 0 200 60" preserveAspectRatio="none">\n            <polyline fill="none" stroke="#9b59b6" stroke-width="2" points="${s}"/>\n            <linearGradient id="grad" x1="0" y1="0" x2="0" y2="1">\n                <stop offset="0%" stop-color="#9b59b6" stop-opacity="0.3"/>\n                <stop offset="100%" stop-color="#9b59b6" stop-opacity="0"/>\n            </linearGradient>\n            <polygon fill="url(#grad)" points="0,60 ${s} 200,60"/>\n        </svg>`;this.postMessage({type:"chart",svg:a})}_getHtmlForWebview(e){const t=a.join(this._extensionUri.fsPath,"resources","webview.html");let n="";try{n=o.readFileSync(t,"utf-8")}catch(e){return"<html><body>Error loading UI</body></html>"}return n}}},571(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.TreeProvider=t.ScanHistoryItem=void 0;const s=n(398);class a extends s.TreeItem{constructor(e,t,n,a){super(e,a),this.label=e,this.date=t,this.results=n,this.collapsibleState=a,this.tooltip=`Scan on ${this.date.toLocaleString()}`,this.description=this.date.toLocaleString(),this.command={command:"supreme2l.showHistoryReport",title:"Show Report",arguments:[this]},this.iconPath=new s.ThemeIcon("history")}}t.ScanHistoryItem=a,t.TreeProvider=class{constructor(){this._onDidChangeTreeData=new s.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event,this.history=[]}refresh(){this._onDidChangeTreeData.fire()}addScan(e){const t=new Date,n=`Scan (${this.getStats(e).total} found)`,o=new a(n,t,e,s.TreeItemCollapsibleState.None);this.history.unshift(o),this.refresh()}getTreeItem(e){return e}getChildren(e){return e?Promise.resolve([]):Promise.resolve(this.history)}getStats(e){let t=0;return e.forEach(e=>t+=e.Issues.length),{total:t}}getHistory(){return this.history.map(e=>({date:e.date,summary:this.getStats(e.results)}))}}},398(e){e.exports=require("vscode")},317(e){e.exports=require("child_process")},896(e){e.exports=require("fs")},857(e){e.exports=require("os")},928(e){e.exports=require("path")}},t={};function n(s){var a=t[s];if(void 0!==a)return a.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,n),o.exports}var s={};(()=>{var e=s;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=n(398),a=n(896),o=n(28),r=n(365),i=n(33),c=n(571),l=n(718),d=n(80);e.activate=function(e){console.log("Supreme 2 Light extension is now active!"),r.PythonBridge.setExtensionPath(e.extensionPath);const n=new i.SidebarProvider(e.extensionUri),s=new c.TreeProvider,p=new l.CodeLensProvider;e.subscriptions.push(t.window.registerWebviewViewProvider(o.CONFIG.VIEWS.DASHBOARD,n),t.window.registerTreeDataProvider(o.CONFIG.VIEWS.RESULTS,s),t.languages.registerCodeLensProvider({scheme:"file"},p)),e.subscriptions.push(t.commands.registerCommand(o.CONFIG.COMMANDS.START_SCAN,async()=>{if(await r.PythonBridge.checkInstallation()){n.setScanningState(!0);try{let e="";if(t.workspace.workspaceFolders&&t.workspace.workspaceFolders.length>0)e=t.workspace.workspaceFolders[0].uri.fsPath;else if(t.window.activeTextEditor&&"file"===t.window.activeTextEditor.document.uri.scheme){const n=t.window.activeTextEditor.document.uri.fsPath;n&&a.existsSync(n)&&(e=n)}else{const s=await t.window.showOpenDialog({canSelectFiles:!0,canSelectFolders:!0,canSelectMany:!1,openLabel:"Scan selected path"});if(!s||0===s.length)return t.window.showErrorMessage("No workspace, file, or path selected to scan."),void n.setScanningState(!1);e=s[0].fsPath}t.window.withProgress({location:t.ProgressLocation.Notification,title:"Supreme 2 Light Scanning",cancellable:!0},async(a,o)=>{o.onCancellationRequested(()=>{r.PythonBridge.stopScan()}),a.report({message:"Initializing..."});try{const o=await r.PythonBridge.runScan(e,e=>{a.report({message:e})});n.setScanningState(!1);const i=o.reduce((e,t)=>e+t.Issues.length,0),c=o.reduce((e,t)=>e+t.Issues.filter(e=>"CRITICAL"===e.Severity).length,0),l=o.reduce((e,t)=>e+t.Issues.filter(e=>"HIGH"===e.Severity).length,0),h=o.reduce((e,t)=>e+t.Issues.filter(e=>"MEDIUM"===e.Severity).length,0),g=o.reduce((e,t)=>e+t.Issues.filter(e=>"LOW"===e.Severity).length,0);n.updateStats(i,c,l,h,g),s.addScan(o),p.updateIssues(o),n.setHistoryData(s.getHistory());const u=t.window.createWebviewPanel("supreme2lReport","Supreme Report",t.ViewColumn.One,{enableScripts:!0});u.webview.html=(0,d.generateReportHtml)(o,u.webview),t.window.showInformationMessage(`Scan complete. Found ${i} issues.`)}catch(e){t.window.showErrorMessage(`Scan failed: ${e.message}`),n.setScanningState(!1)}})}catch(e){n.setScanningState(!1),t.window.showErrorMessage(`Error starting scan: ${e.message}`)}}else"Install"===await t.window.showWarningMessage("Supreme 2 Light is not detected. Install it via pip?","Install","Cancel")&&t.commands.executeCommand(o.CONFIG.COMMANDS.INSTALL_TOOLS)}),t.commands.registerCommand(o.CONFIG.COMMANDS.STOP_SCAN,()=>{r.PythonBridge.stopScan(),n.setScanningState(!1)}),t.commands.registerCommand(o.CONFIG.COMMANDS.EXPORT_REPORT,async()=>{t.window.showInformationMessage("Export functionality coming soon!")}),t.commands.registerCommand(o.CONFIG.COMMANDS.INSTALL_TOOLS,()=>{r.PythonBridge.installTools()}),t.commands.registerCommand("supreme2l.showHistoryReport",e=>{const n=t.window.createWebviewPanel("supreme2lReport",`Report: ${e.date.toLocaleString()}`,t.ViewColumn.One,{enableScripts:!0});n.webview.html=(0,d.generateReportHtml)(e.results,n.webview)}));const h=t.window.createStatusBarItem(t.StatusBarAlignment.Left);h.text="$(shield) Supreme 2 Light",h.command=o.CONFIG.COMMANDS.START_SCAN,h.show(),e.subscriptions.push(h)},e.deactivate=function(){r.PythonBridge.stopScan()}})();var a=exports;for(var o in s)a[o]=s[o];s.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();