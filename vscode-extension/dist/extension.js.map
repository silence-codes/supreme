{"version":3,"file":"extension.js","mappings":"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","sources":["../.././src/codeLensProvider.ts","../.././src/config.ts","../.././src/pythonBridge.ts","../.././src/report.ts","../.././src/sidebarProvider.ts","../.././src/treeProvider.ts","../../external commonjs \"vscode\"","../../external node-commonjs \"child_process\"","../../external node-commonjs \"fs\"","../../external node-commonjs \"os\"","../../external node-commonjs \"path\"","../../webpack/bootstrap","../.././src/extension.ts"],"sourcesContent":["import * as vscode from 'vscode';\nimport { ScanResult, ScanIssue } from './pythonBridge';\n\nexport class CodeLensProvider implements vscode.CodeLensProvider {\n    private _onDidChangeCodeLenses: vscode.EventEmitter<void> = new vscode.EventEmitter<void>();\n    public readonly onDidChangeCodeLenses: vscode.Event<void> = this._onDidChangeCodeLenses.event;\n\n    private issuesMap: Map<string, ScanIssue[]> = new Map();\n\n    public updateIssues(results: ScanResult[]) {\n        this.issuesMap.clear();\n        results.forEach(file => {\n            // Normalize path for map lookup (VS Code URIs usually are consistent)\n            // Ideally we use vscode.Uri.file(path).toString()\n            const uri = vscode.Uri.file(file.Target).toString();\n            this.issuesMap.set(uri, file.Issues);\n        });\n        this._onDidChangeCodeLenses.fire();\n    }\n\n    public provideCodeLenses(document: vscode.TextDocument, token: vscode.CancellationToken): vscode.CodeLens[] | Thenable<vscode.CodeLens[]> {\n        const uri = document.uri.toString();\n        const issues = this.issuesMap.get(uri);\n\n        if (!issues || issues.length === 0) {\n            return [];\n        }\n\n        const lenses: vscode.CodeLens[] = [];\n\n        // Group by line to avoid clutter? Or just one lens per issue?\n        // Let's group by line.\n        const lineMap: Map<number, ScanIssue[]> = new Map();\n\n        issues.forEach(issue => {\n            const line = (issue.StartLine || 1) - 1; // 0-indexed\n            if (!lineMap.has(line)) {\n                lineMap.set(line, []);\n            }\n            lineMap.get(line)?.push(issue);\n        });\n\n        lineMap.forEach((lineIssues, line) => {\n            const range = new vscode.Range(line, 0, line, 0);\n            const count = lineIssues.length;\n            const severity = lineIssues.some(i => i.Severity === 'CRITICAL' || i.Severity === 'HIGH') ? 'ðŸ”´' : 'Vk';\n            const title = `${severity} ${count} Supreme Issue${count > 1 ? 's' : ''}: ${lineIssues[0].Name}`;\n\n            const cmd = {\n                title: title,\n                tooltip: lineIssues.map(i => `[${i.Severity}] ${i.Name}: ${i.Description}`).join('\\n'),\n                command: '', // Could open a details view?\n                arguments: []\n            };\n\n            lenses.push(new vscode.CodeLens(range, cmd));\n        });\n\n        return lenses;\n    }\n}\n","import * as vscode from 'vscode';\nimport * as fs from 'fs';\nimport * as path from 'path';\n\nimport * as os from 'os';\n\nexport const CONFIG = {\n    COMMANDS: {\n        START_SCAN: 'supreme2l.startScan',\n        STOP_SCAN: 'supreme2l.stopScan',\n        EXPORT_REPORT: 'supreme2l.exportReport',\n        INSTALL_TOOLS: 'supreme2l.installTools'\n    },\n    VIEWS: {\n        DASHBOARD: 'supreme2l-dashboard',\n        RESULTS: 'supreme2l-results'\n    },\n    SETTINGS: {\n        PYTHON_PATH: 'supreme2l.pythonPath',\n        EXCLUDE_PATHS: 'supreme2l.excludePaths',\n        SEVERITY_FILTER: 'supreme2l.severityFilter'\n    }\n};\n\nexport function getGlobalVenvPath(): string {\n    return path.join(os.homedir(), '.supreme2l', 'venv');\n}\n\nexport function getGlobalPythonPath(): string {\n    const venvPath = getGlobalVenvPath();\n    const isWin = process.platform === 'win32';\n    return path.join(venvPath, isWin ? 'Scripts' : 'bin', isWin ? 'python.exe' : 'python');\n}\n\nexport function getPythonPath(): string {\n    const config = vscode.workspace.getConfiguration();\n    const settingPath = config.get<string>(CONFIG.SETTINGS.PYTHON_PATH);\n    if (settingPath) {\n        return settingPath;\n    }\n\n    // 1. Check Global Managed Venv\n    const globalPython = getGlobalPythonPath();\n    if (fs.existsSync(globalPython)) {\n        return globalPython;\n    }\n\n    // 2. Check if the Python extension has a selected interpreter\n    const pythonConfig = vscode.workspace.getConfiguration('python');\n    const pythonInterpreter = pythonConfig.get<string>('defaultInterpreterPath');\n    if (pythonInterpreter && pythonInterpreter !== 'python' && fs.existsSync(pythonInterpreter)) {\n        return pythonInterpreter;\n    }\n\n    // 3. Try to auto-detect venv in workspace root\n    const workspaceFolders = vscode.workspace.workspaceFolders;\n    if (workspaceFolders && workspaceFolders.length > 0) {\n        const rootPath = workspaceFolders[0].uri.fsPath;\n        const venvPaths = [\n            path.join(rootPath, '.venv', 'bin', 'python'),\n            path.join(rootPath, '.venv', 'Scripts', 'python.exe'),\n            path.join(rootPath, 'venv', 'bin', 'python'),\n            path.join(rootPath, 'venv', 'Scripts', 'python.exe'),\n        ];\n\n        for (const p of venvPaths) {\n            if (fs.existsSync(p)) {\n                return p;\n            }\n        }\n    }\n\n    return 'python3';\n}\n\nexport function getExcludePaths(): string[] {\n    const config = vscode.workspace.getConfiguration();\n    return config.get<string[]>(CONFIG.SETTINGS.EXCLUDE_PATHS) || [];\n}\n","import * as vscode from 'vscode';\nimport * as cp from 'child_process';\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport * as os from 'os';\nimport { getPythonPath, getGlobalPythonPath, getGlobalVenvPath } from './config';\n\nexport interface ScanIssue {\n    ID: string;\n    Name: string;\n    Severity: string;\n    Description: string;\n    Type: string;\n    StartLine?: number;\n    CodeSnippet?: string;\n    CWE?: string;\n    CWELink?: string;\n}\n\nexport interface ScanResult {\n    Target: string;\n    Issues: ScanIssue[];\n}\n\n// ... (interfaces remain same)\n\nexport class PythonBridge {\n    private static childProcess: cp.ChildProcess | null = null;\n    private static outputChannel = vscode.window.createOutputChannel(\"Supreme 2 Light\");\n    private static extensionPath: string = \"\";\n\n    static setExtensionPath(path: string) {\n        this.extensionPath = path;\n    }\n\n    static async checkInstallation(): Promise<boolean> {\n        const python = getPythonPath();\n        return new Promise((resolve) => {\n            const checkProcess = cp.spawn(python, ['-m', 'supreme2l', '--version']);\n            let stdout = '';\n            let stderr = '';\n\n            checkProcess.stdout?.on('data', (chunk) => {\n                stdout += chunk.toString();\n            });\n\n            checkProcess.stderr?.on('data', (chunk) => {\n                stderr += chunk.toString();\n            });\n\n            checkProcess.on('error', (err) => {\n                this.outputChannel.appendLine(`Installation check failed with ${python}: ${err.message}`);\n                resolve(false);\n            });\n\n            checkProcess.on('close', (code) => {\n                if (code === 0) {\n                    this.outputChannel.appendLine(`Supreme 2 Light found: ${stdout.trim()}`);\n                    resolve(true);\n                    return;\n                }\n\n                const details = stderr.trim() || stdout.trim();\n                this.outputChannel.appendLine(`Installation check failed with ${python} (code ${code}). ${details}`);\n                resolve(false);\n            });\n        });\n    }\n\n    static async installTools() {\n        const workspaceFolder = vscode.workspace.workspaceFolders?.[0]?.uri.fsPath;\n        const activeEditorPath = vscode.window.activeTextEditor?.document.uri.fsPath;\n        let installTarget = workspaceFolder || (activeEditorPath ? path.dirname(activeEditorPath) : \"\");\n\n        if (!installTarget) {\n            const picked = await vscode.window.showOpenDialog({\n                canSelectFiles: false,\n                canSelectFolders: true,\n                canSelectMany: false,\n                openLabel: \"Select project folder for install\"\n            });\n            if (!picked || picked.length === 0) {\n                vscode.window.showWarningMessage(\"Install canceled: no target folder selected.\");\n                return;\n            }\n            installTarget = picked[0].fsPath;\n        }\n\n        const terminal = vscode.window.createTerminal({\n            name: \"Supreme 2 Light Installer\",\n            cwd: installTarget\n        });\n        terminal.show();\n\n        const sendExecutable = (executablePath: string, args: string[]) => {\n            const quoteArg = (arg: string) => `\"${arg.replace(/\"/g, '\\\\\"')}\"`;\n            const formattedArgs = args\n                .map((arg) => quoteArg(arg))\n                .join(' ');\n\n            if (process.platform === 'win32') {\n                // Use cmd wrapper so paths work reliably from both PowerShell and CMD terminals.\n                terminal.sendText(`cmd /d /c \"\"${executablePath}\" ${formattedArgs}\"`);\n            } else {\n                terminal.sendText(`\"${executablePath}\" ${formattedArgs}`);\n            }\n        };\n\n        // 1. Check if supreme2l is installed reachable via getPythonPath()\n        const isInstalled = await this.checkInstallation();\n        // Force reinstall if needed, or check version? \n        // For now, if installed, assume user might want to update or is fine. \n        // But if we just shipped a fix, we might want to force update?\n        // Let's rely on \"Install Tools\" command always trying to update supreme2l package first.\n\n        const pythonPath = getGlobalPythonPath();\n\n        // Define wheel path\n        const wheelName = \"supreme2l-1.0.9-py3-none-any.whl\";\n        const wheelPath = this.extensionPath\n            ? path.join(this.extensionPath, 'resources', wheelName)\n            : \"\";\n\n        // If simple check passed, we might still want to ensure we have the LATEST version from our bundle.\n        // So we proceed to venv setup/update regardless if triggered manually via installTools.\n\n        // 2. Setup/Ensure Venv\n        const venvPath = getGlobalVenvPath();\n        terminal.sendText(`echo \"Setting up/Updating Supreme 2 Light environment at ${venvPath}...\"`);\n        terminal.sendText(`echo \"Project target: ${installTarget}\"`);\n\n        if (!fs.existsSync(pythonPath)) {\n            let systemPython = 'python3';\n            if (process.platform === 'win32') systemPython = 'python';\n            terminal.sendText(`${systemPython} -m venv \"${venvPath}\"`);\n        }\n\n        // 3. Install/Update supreme2l from bundled wheel\n        if (wheelPath && fs.existsSync(wheelPath)) {\n            terminal.sendText(`echo \"Installing Supreme 2 Light v1.0.9 from bundle...\"`);\n            // Force reinstall to ensure we get the new version even if 1.0.0 is present\n            sendExecutable(pythonPath, ['-m', 'pip', 'install', '--force-reinstall', wheelPath]);\n        } else {\n            terminal.sendText(`echo \"Warning: Bundled wheel not found at ${wheelPath}. Trying PyPI...\"`);\n            sendExecutable(pythonPath, ['-m', 'pip', 'install', '--upgrade', 'supreme2l']);\n        }\n\n        // 4. Run supreme2l install\n        sendExecutable(pythonPath, ['-m', 'supreme2l', 'install', '--smart', '--yes', '--target', installTarget]);\n\n        // 5. Notify\n        terminal.sendText(`echo \"Installation complete! You can now Scan.\"`);\n    }\n\n    static async runScan(target: string, onProgress?: (msg: string) => void): Promise<ScanResult[]> {\n        if (this.childProcess) {\n            throw new Error(\"Scan already running\");\n        }\n\n        const python = getPythonPath();\n        // Create a temporary directory for this scan\n        const tmpDir = fs.mkdtempSync(path.join(os.tmpdir(), 's2l-scan-'));\n\n        // Build arguments\n        // s2l scan <target> --format json -o <tmpDir>\n        // CLI treats -o as a directory and generates a file inside it\n        const args = ['-m', 'supreme2l', 'scan', target, '--format', 'json', '--output', tmpDir, '--no-install'];\n\n        let scanCwd = process.cwd();\n        try {\n            if (fs.existsSync(target)) {\n                const stat = fs.statSync(target);\n                scanCwd = stat.isDirectory() ? target : path.dirname(target);\n            }\n        } catch {\n            // Keep process cwd fallback.\n        }\n\n        this.outputChannel.appendLine(`Starting scan: ${python} ${args.join(' ')}`);\n        this.outputChannel.appendLine(`Scan CWD: ${scanCwd}`);\n        if (onProgress) onProgress(\"Initializing scan...\");\n\n        return new Promise((resolve, reject) => {\n            this.childProcess = cp.spawn(python, args, { cwd: scanCwd });\n\n            this.childProcess.stdout?.on('data', (data) => {\n                const output = data.toString();\n                this.outputChannel.append(output);\n                if (onProgress) {\n                    if (output.includes('Scanning')) onProgress(\"Scanning files...\");\n                    if (output.includes('Analyzing')) onProgress(\"Analyzing results...\");\n                }\n            });\n\n            this.childProcess.stderr?.on('data', (data) => {\n                this.outputChannel.append(`ERR: ${data.toString()}`);\n            });\n\n            this.childProcess.on('close', (code) => {\n                this.childProcess = null;\n                if (code === 0) {\n                    try {\n                        const files = fs.readdirSync(tmpDir).filter((f) => f.endsWith('.json'));\n                        const preferred = files\n                            .filter((f) => f.startsWith('supreme2l-scan-'))\n                            .sort((a, b) => a.localeCompare(b))\n                            .reverse();\n                        const fallback = files.filter((f) => f !== 'scan_history.json');\n                        const candidates = [...preferred, ...fallback.filter((f) => !preferred.includes(f))];\n\n                        let parsedReport: any = null;\n                        for (const fileName of candidates) {\n                            const fullPath = path.join(tmpDir, fileName);\n                            try {\n                                const raw = fs.readFileSync(fullPath, 'utf-8');\n                                const parsed = JSON.parse(raw);\n                                if (!Array.isArray(parsed) && parsed && Array.isArray(parsed.findings)) {\n                                    parsedReport = parsed;\n                                    break;\n                                }\n                            } catch {\n                                // Ignore malformed file and continue with next candidate.\n                            }\n                        }\n\n                        if (parsedReport) {\n                            const results = this.parseResults(parsedReport, target);\n\n                            try {\n                                fs.rmSync(tmpDir, { recursive: true, force: true });\n                            } catch (e) {\n                                console.error(`Failed to clean up temp files: ${e}`);\n                            }\n\n                            resolve(results);\n                        } else {\n                            reject(new Error(\"No JSON report generated in output directory\"));\n                        }\n                    } catch (e) {\n                        reject(new Error(`Failed to parse results: ${e}`));\n                    }\n                } else {\n                    reject(new Error(`Scan failed with code ${code}`));\n                }\n            });\n        });\n    }\n\n    static stopScan() {\n        if (this.childProcess) {\n            this.childProcess.kill();\n            this.childProcess = null;\n            this.outputChannel.appendLine(\"Scan stopped by user.\");\n        }\n    }\n\n    private static parseResults(json: any, targetRoot: string): ScanResult[] {\n        // Supreme 2 Light JSON structure:\n        // {\n        //   \"metadata\": { ... },\n        //   \"summary\": { ... },\n        //   \"findings\": [\n        //     {\n        //       \"file\": \"path/to/file\",\n        //       \"line\": 10,\n        //       \"message\": \"...\",\n        //       \"severity\": \"HIGH\",\n        //       \"tool\": \"bandit\",\n        //       \"rule_id\": \"B101\",\n        //       ...\n        //     }\n        //   ]\n        // }\n\n        const findings = json.findings || [];\n        const resultMap: Map<string, ScanIssue[]> = new Map();\n\n        for (const finding of findings) {\n            const file = finding.file || \"unknown\";\n            const cweValue = typeof finding.cwe_id === 'number'\n                ? `CWE-${finding.cwe_id}`\n                : (typeof finding.cwe === 'string' && finding.cwe ? finding.cwe : undefined);\n\n            const issue: ScanIssue = {\n                ID: finding.rule_id || cweValue || \"UNKNOWN\",\n                Name: finding.message || finding.issue || \"Unknown Issue\",\n                Severity: (finding.severity || \"INFO\").toUpperCase(),\n                Description: finding.description || finding.message || finding.issue || \"No description available\",\n                Type: finding.tool || finding.scanner || \"S2L\",\n                StartLine: finding.line,\n                CodeSnippet: finding.code,\n                CWE: cweValue,\n                CWELink: finding.cwe_link\n            };\n\n            if (!resultMap.has(file)) {\n                resultMap.set(file, []);\n            }\n            resultMap.get(file)?.push(issue);\n        }\n\n        const results: ScanResult[] = [];\n        resultMap.forEach((issues, file) => {\n            // Make path relative if possible? Or keep absolute?\n            // VS Code usually prefers absolute or relative to workspace. \n            // S2L output might depend. Let's assume S2L returns what was passed or relative.\n            // basic.py says: 'file': self.file_path\n            results.push({\n                Target: file,\n                Issues: issues\n            });\n        });\n\n        return results;\n    }\n}\n","import * as vscode from 'vscode';\nimport { ScanResult, ScanIssue } from './pythonBridge';\n\n// Helper function to escape HTML to prevent XSS\nfunction escapeHtml(unsafe: string): string {\n    return unsafe\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n        .replace(/\"/g, \"&quot;\")\n        .replace(/'/g, \"&#039;\");\n}\n\nexport function generateReportHtml(results: ScanResult[], webview: vscode.Webview): string {\n    const style = `\n        :root {\n            --glass-bg: rgba(30, 30, 30, 0.6);\n            --glass-border: rgba(255, 255, 255, 0.1);\n            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);\n            --primary-color: #9b59b6;\n            --text-color: #e0e0e0;\n            --code-bg: #0d0d0d;\n        }\n\n        * {\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;\n            background-color: #050505;\n            background-image: \n                radial-gradient(circle at 15% 50%, rgba(155, 89, 182, 0.08), transparent 25%), \n                radial-gradient(circle at 85% 30%, rgba(52, 152, 219, 0.08), transparent 25%);\n            background-attachment: fixed;\n            color: var(--text-color);\n            padding: 40px 20px;\n            margin: 0;\n            line-height: 1.6;\n        }\n\n        .container {\n            max-width: 1000px;\n            margin: 0 auto;\n        }\n\n        h1 {\n            font-size: 2.5rem;\n            font-weight: 200;\n            color: #fff;\n            margin-bottom: 0.5rem;\n            letter-spacing: -1px;\n        }\n\n        .subtitle {\n            color: #888;\n            margin-bottom: 3rem;\n            font-size: 1.1rem;\n            font-weight: 300;\n            display: flex;\n            gap: 15px;\n            align-items: center;\n        }\n\n        .card {\n            background: var(--glass-bg);\n            border-radius: 12px;\n            box-shadow: var(--glass-shadow);\n            backdrop-filter: blur(8px);\n            -webkit-backdrop-filter: blur(8px);\n            border: 1px solid var(--glass-border);\n            margin-bottom: 2rem;\n            padding: 1.5rem;\n            overflow: hidden;\n            position: relative;\n        }\n        \n        .card::before {\n            content: '';\n            position: absolute;\n            top: 0; left: 0; bottom: 0; width: 4px;\n            background: #555; \n        }\n        .card.severity-CRITICAL::before { background: #ff5252; box-shadow: 0 0 10px #ff5252; }\n        .card.severity-HIGH::before { background: #ffb142; }\n        .card.severity-MEDIUM::before { background: #ffda79; }\n        .card.severity-LOW::before { background: #34ace0; }\n        .card.severity-INFO::before { background: #636e72; }\n\n        .card-header {\n            display: flex;\n            flex-wrap: wrap;\n            justify-content: space-between;\n            align-items: flex-start;\n            gap: 15px;\n            margin-bottom: 1rem;\n        }\n\n        .issue-main {\n            flex: 1;\n            min-width: 250px;\n        }\n\n        .issue-title {\n            font-size: 1.4rem;\n            font-weight: 600;\n            color: #fff;\n            margin-top: 8px;\n            word-break: break-word;\n            line-height: 1.3;\n        }\n\n        .badges {\n            display: flex;\n            gap: 8px;\n            flex-wrap: wrap;\n        }\n\n        .badge {\n            padding: 4px 10px;\n            border-radius: 4px;\n            font-size: 0.75rem;\n            font-weight: 700;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n            white-space: nowrap;\n        }\n\n        .badge-type { background: rgba(255, 255, 255, 0.1); color: #aaa; }\n\n        .severity-badge {\n            background: #333;\n            color: #fff;\n        }\n        .severity-badge.CRITICAL { color: #ff5252; background: rgba(255, 82, 82, 0.15); }\n        .severity-badge.HIGH { color: #ffb142; background: rgba(255, 177, 66, 0.15); }\n        .severity-badge.MEDIUM { color: #ffda79; background: rgba(255, 218, 121, 0.15); }\n        .severity-badge.LOW { color: #34ace0; background: rgba(52, 172, 224, 0.15); }\n        .severity-badge.INFO { color: #636e72; background: rgba(99, 110, 114, 0.15); }\n\n        .description {\n            color: #ccc;\n            margin-bottom: 1.5rem;\n            font-size: 1rem;\n            word-wrap: break-word;\n        }\n\n        .code-block {\n            background: var(--code-bg);\n            padding: 1rem;\n            border-radius: 6px;\n            border: 1px solid #222;\n            font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;\n            font-size: 0.85rem;\n            overflow-x: auto;\n            color: #d4d4d4;\n            margin: 1.5rem 0;\n            white-space: pre;\n            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);\n        }\n\n        .meta-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));\n            gap: 20px;\n            padding-top: 1.5rem;\n            border-top: 1px solid rgba(255, 255, 255, 0.05);\n        }\n\n        .meta-item {\n            display: flex;\n            flex-direction: column;\n            gap: 5px;\n        }\n\n        .meta-label {\n            font-size: 0.7rem;\n            text-transform: uppercase;\n            color: #666;\n            font-weight: 600;\n            letter-spacing: 1px;\n        }\n\n        .meta-value {\n            font-size: 0.9rem;\n            color: #eee;\n            word-break: break-all;\n            font-family: monospace;\n        }\n\n        a.meta-value {\n            color: #a29bfe;\n            text-decoration: none;\n            transition: opacity 0.2s;\n        }\n        a.meta-value:hover {\n            opacity: 0.8;\n            text-decoration: underline;\n        }\n    `;\n\n    let content = '';\n    let totalIssues = 0;\n\n    results.forEach(target => {\n        if (!target.Issues || target.Issues.length === 0) return;\n\n        target.Issues.forEach(issue => {\n            totalIssues++;\n            const filePath = target.Target;\n            const commandUri = `command:vscode.open?${encodeURIComponent(JSON.stringify(vscode.Uri.file(filePath)))}`;\n\n            // Encode code snippet safely\n            const safeCode = issue.CodeSnippet\n                ? issue.CodeSnippet.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\")\n                : null;\n\n            const codeHtml = safeCode\n                ? `<div class=\"code-block\">${safeCode}</div>`\n                : `<div style=\"font-style:italic; color:#666; margin: 10px 0; font-size:0.9em;\">No code snippet available (Line ${issue.StartLine || 'unknown'})</div>`;\n\n            const cweHtml = issue.CWE\n                ? `<div class=\"meta-item\"><span class=\"meta-label\">CWE</span><a href=\"${issue.CWELink || '#'}\" class=\"meta-value\">${issue.CWE}</a></div>`\n                : '';\n\n            content += `\n                <div class=\"card severity-${issue.Severity}\">\n                    <div class=\"card-header\">\n                        <div class=\"issue-main\">\n                            <div class=\"badges\">\n                                <span class=\"badge badge-type\">${escapeHtml(issue.Type)}</span>\n                                <span class=\"badge severity-badge ${issue.Severity}\">${issue.Severity}</span>\n                            </div>\n                            <div class=\"issue-title\">${escapeHtml(issue.Name)}</div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"description\">${escapeHtml(issue.Description || 'No description available.')}</div>\n                    \n                    ${codeHtml}\n\n                    <div class=\"meta-grid\">\n                        <div class=\"meta-item\">\n                            <span class=\"meta-label\">Identifier</span>\n                            <span class=\"meta-value\">${escapeHtml(issue.ID)}</span>\n                        </div>\n                        <div class=\"meta-item\">\n                            <span class=\"meta-label\">Location</span>\n                            <a href=\"${commandUri}\" class=\"meta-value\" title=\"Open File\">${filePath}${issue.StartLine ? `:${issue.StartLine}` : ''}</a>\n                        </div>\n                        ${cweHtml}\n                    </div>\n                </div>\n            `;\n        });\n    });\n\n    if (totalIssues === 0) {\n        content = `\n            <div style=\"text-align:center; margin-top: 100px; opacity: 0.7;\">\n                <h2 style=\"color: #2ecc71; margin-top: 20px;\">All systems operational</h2>\n                <p>No vulnerabilities found.</p>\n            </div>`;\n    }\n\n    return `\n        <!DOCTYPE html>\n        <html lang=\"en\">\n        <head>\n            <meta charset=\"UTF-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <title>Supreme Report</title>\n            <style>${style}</style>\n        </head>\n        <body>\n            <div class=\"container\">\n                <h1>Supreme Report</h1>\n                <div class=\"subtitle\">\n                    <span>${new Date().toLocaleString()}</span>\n                    <span>&bull;</span>\n                    <span>${totalIssues} issues detected</span>\n                </div>\n                ${content}\n            </div>\n        </body>\n        </html>\n    `;\n}\n","import * as vscode from 'vscode';\nimport * as path from 'path';\nimport * as fs from 'fs';\n\nexport class SidebarProvider implements vscode.WebviewViewProvider {\n    private _view?: vscode.WebviewView;\n    private pendingMessages: any[] = [];\n\n    private isScanning: boolean = false;\n\n    constructor(private readonly _extensionUri: vscode.Uri) { }\n\n    public resolveWebviewView(\n        webviewView: vscode.WebviewView,\n        context: vscode.WebviewViewResolveContext,\n        _token: vscode.CancellationToken,\n    ) {\n        this._view = webviewView;\n\n        webviewView.webview.options = {\n            enableScripts: true,\n            localResourceRoots: [this._extensionUri],\n        };\n\n        webviewView.webview.html = this._getHtmlForWebview(webviewView.webview);\n\n        webviewView.webview.onDidReceiveMessage(data => {\n            switch (data.type) {\n                case 'startScan': {\n                    vscode.commands.executeCommand('supreme2l.startScan');\n                    break;\n                }\n                case 'stopScan': {\n                    vscode.commands.executeCommand('supreme2l.stopScan');\n                    break;\n                }\n                case 'export': {\n                    vscode.commands.executeCommand('supreme2l.exportReport');\n                    break;\n                }\n                case 'installTools': {\n                    vscode.commands.executeCommand('supreme2l.installTools');\n                    break;\n                }\n                case 'ready': {\n                    this.sendInitialState();\n                    break;\n                }\n            }\n        });\n\n        // Send any pending messages that were queued before webview was ready\n        this.pendingMessages.forEach(msg => webviewView.webview.postMessage(msg));\n        this.pendingMessages = [];\n    }\n\n    private sendInitialState() {\n        this.postMessage({ type: 'state', isScanning: this.isScanning });\n    }\n\n    private postMessage(message: any) {\n        if (this._view) {\n            this._view.webview.postMessage(message);\n        } else {\n            this.pendingMessages.push(message);\n        }\n    }\n\n    public setScanningState(isScanning: boolean) {\n        this.isScanning = isScanning;\n        this.postMessage({ type: 'state', isScanning: this.isScanning });\n    }\n\n    public updateStats(total: number, critical: number, high: number, medium: number, low: number) {\n        // Calculate Score (Weighted Deduction: Start at 100)\n        // Critical = -10, High = -5, Medium = -2, Low = -1\n        let rawScore = 100 - (critical * 10) - (high * 5) - (medium * 2) - (low * 1);\n        if (rawScore < 0) rawScore = 0;\n        const score = Math.round(rawScore);\n\n        this.postMessage({ type: 'stats', total, critical, high, score });\n    }\n\n    public setHistoryData(history: any[]) {\n        // Generate SVG Chart points\n        // Take last 7 scans\n        const data = history.slice(0, 7).reverse();\n        if (data.length < 2) {\n            this.postMessage({ type: 'chart', svg: '' });\n            return;\n        }\n\n        const width = 200;\n        const height = 60;\n        const max = Math.max(...data.map(d => (d.summary ? d.summary.total : 0))) || 1;\n\n        const points = data.map((d, i) => {\n            const x = (i / (data.length - 1)) * width;\n            const val = d.summary ? d.summary.total : 0;\n            const y = height - (val / max) * height;\n            return `${x},${y}`;\n        }).join(' ');\n\n        const svg = `<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 ${width} ${height}\" preserveAspectRatio=\"none\">\n            <polyline fill=\"none\" stroke=\"#9b59b6\" stroke-width=\"2\" points=\"${points}\"/>\n            <linearGradient id=\"grad\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                <stop offset=\"0%\" stop-color=\"#9b59b6\" stop-opacity=\"0.3\"/>\n                <stop offset=\"100%\" stop-color=\"#9b59b6\" stop-opacity=\"0\"/>\n            </linearGradient>\n            <polygon fill=\"url(#grad)\" points=\"0,${height} ${points} ${width},${height}\"/>\n        </svg>`;\n\n        this.postMessage({ type: 'chart', svg });\n    }\n\n    private _getHtmlForWebview(webview: vscode.Webview) {\n        const htmlPath = path.join(this._extensionUri.fsPath, 'resources', 'webview.html');\n\n        let htmlContent = '';\n        try {\n            htmlContent = fs.readFileSync(htmlPath, 'utf-8');\n        } catch (e) {\n            return `<html><body>Error loading UI</body></html>`;\n        }\n\n        return htmlContent;\n    }\n}\n","import * as vscode from 'vscode';\nimport { ScanResult } from './pythonBridge';\nimport { generateReportHtml } from './report';\n\nexport class ScanHistoryItem extends vscode.TreeItem {\n    constructor(\n        public readonly label: string,\n        public readonly date: Date,\n        public readonly results: ScanResult[],\n        public readonly collapsibleState: vscode.TreeItemCollapsibleState\n    ) {\n        super(label, collapsibleState);\n        this.tooltip = `Scan on ${this.date.toLocaleString()}`;\n        this.description = this.date.toLocaleString();\n        this.command = {\n            command: 'supreme2l.showHistoryReport',\n            title: 'Show Report',\n            arguments: [this]\n        };\n        this.iconPath = new vscode.ThemeIcon('history');\n    }\n}\n\nexport class TreeProvider implements vscode.TreeDataProvider<ScanHistoryItem> {\n    private _onDidChangeTreeData: vscode.EventEmitter<ScanHistoryItem | undefined | null | void> = new vscode.EventEmitter<ScanHistoryItem | undefined | null | void>();\n    readonly onDidChangeTreeData: vscode.Event<ScanHistoryItem | undefined | null | void> = this._onDidChangeTreeData.event;\n\n    private history: ScanHistoryItem[] = [];\n\n    refresh(): void {\n        this._onDidChangeTreeData.fire();\n    }\n\n    addScan(results: ScanResult[]) {\n        const date = new Date();\n        const stats = this.getStats(results);\n        const label = `Scan (${stats.total} found)`;\n        const item = new ScanHistoryItem(label, date, results, vscode.TreeItemCollapsibleState.None);\n        this.history.unshift(item); // Add to top\n        this.refresh();\n    }\n\n    getTreeItem(element: ScanHistoryItem): vscode.TreeItem {\n        return element;\n    }\n\n    getChildren(element?: ScanHistoryItem): Thenable<ScanHistoryItem[]> {\n        if (element) {\n            return Promise.resolve([]); // No children for now\n        }\n        return Promise.resolve(this.history);\n    }\n\n    private getStats(results: ScanResult[]) {\n        let total = 0;\n        results.forEach(f => total += f.Issues.length);\n        return { total };\n    }\n\n    getHistory(): any[] {\n        return this.history.map(item => ({\n            date: item.date,\n            summary: this.getStats(item.results)\n        }));\n    }\n}\n","module.exports = require(\"vscode\");","module.exports = require(\"child_process\");","module.exports = require(\"fs\");","module.exports = require(\"os\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import * as vscode from 'vscode';\nimport * as fs from 'fs';\nimport { CONFIG } from './config';\nimport { PythonBridge, ScanResult } from './pythonBridge';\nimport { SidebarProvider } from './sidebarProvider';\nimport { TreeProvider, ScanHistoryItem } from './treeProvider';\nimport { CodeLensProvider } from './codeLensProvider';\nimport { generateReportHtml } from './report';\n\nexport function activate(context: vscode.ExtensionContext) {\n    console.log('Supreme 2 Light extension is now active!');\n\n    // Initialize Python Bridge\n    PythonBridge.setExtensionPath(context.extensionPath);\n\n    // Initialize Providers\n    const sidebarProvider = new SidebarProvider(context.extensionUri);\n    const treeProvider = new TreeProvider();\n    const codeLensProvider = new CodeLensProvider();\n\n    // Register Providers\n    context.subscriptions.push(\n        vscode.window.registerWebviewViewProvider(CONFIG.VIEWS.DASHBOARD, sidebarProvider),\n        vscode.window.registerTreeDataProvider(CONFIG.VIEWS.RESULTS, treeProvider),\n        vscode.languages.registerCodeLensProvider({ scheme: 'file' }, codeLensProvider)\n    );\n\n    // Register Commands\n    context.subscriptions.push(\n        vscode.commands.registerCommand(CONFIG.COMMANDS.START_SCAN, async () => {\n            // Check installation first\n            const isInstalled = await PythonBridge.checkInstallation();\n            if (!isInstalled) {\n                const selection = await vscode.window.showWarningMessage(\n                    \"Supreme 2 Light is not detected. Install it via pip?\",\n                    \"Install\", \"Cancel\"\n                );\n                if (selection === 'Install') {\n                    vscode.commands.executeCommand(CONFIG.COMMANDS.INSTALL_TOOLS);\n                }\n                return;\n            }\n\n            // Start Scan\n            sidebarProvider.setScanningState(true);\n\n            try {\n                // Determine target: workspace root or current file\n                let target = '';\n                if (vscode.workspace.workspaceFolders && vscode.workspace.workspaceFolders.length > 0) {\n                    target = vscode.workspace.workspaceFolders[0].uri.fsPath;\n                } else if (\n                    vscode.window.activeTextEditor &&\n                    vscode.window.activeTextEditor.document.uri.scheme === 'file'\n                ) {\n                    const editorPath = vscode.window.activeTextEditor.document.uri.fsPath;\n                    if (editorPath && fs.existsSync(editorPath)) {\n                        target = editorPath;\n                    }\n                } else {\n                    const picked = await vscode.window.showOpenDialog({\n                        canSelectFiles: true,\n                        canSelectFolders: true,\n                        canSelectMany: false,\n                        openLabel: \"Scan selected path\"\n                    });\n\n                    if (!picked || picked.length === 0) {\n                        vscode.window.showErrorMessage(\"No workspace, file, or path selected to scan.\");\n                        sidebarProvider.setScanningState(false);\n                        return;\n                    }\n\n                    target = picked[0].fsPath;\n                }\n\n                vscode.window.withProgress({\n                    location: vscode.ProgressLocation.Notification,\n                    title: \"Supreme 2 Light Scanning\",\n                    cancellable: true\n                }, async (progress, token) => {\n                    token.onCancellationRequested(() => {\n                        PythonBridge.stopScan();\n                    });\n\n                    progress.report({ message: \"Initializing...\" });\n\n                    try {\n                        const results = await PythonBridge.runScan(target, (msg) => {\n                            progress.report({ message: msg });\n                        });\n\n                        // Scan Complete\n                        sidebarProvider.setScanningState(false);\n\n                        // Update stats\n                        const total = results.reduce((acc, r) => acc + r.Issues.length, 0);\n                        const critical = results.reduce((acc, r) => acc + r.Issues.filter(i => i.Severity === 'CRITICAL').length, 0);\n                        const high = results.reduce((acc, r) => acc + r.Issues.filter(i => i.Severity === 'HIGH').length, 0);\n                        const medium = results.reduce((acc, r) => acc + r.Issues.filter(i => i.Severity === 'MEDIUM').length, 0);\n                        const low = results.reduce((acc, r) => acc + r.Issues.filter(i => i.Severity === 'LOW').length, 0);\n                        sidebarProvider.updateStats(total, critical, high, medium, low);\n\n                        treeProvider.addScan(results);\n                        codeLensProvider.updateIssues(results);\n\n                        // Update chart\n                        sidebarProvider.setHistoryData(treeProvider.getHistory());\n\n                        // Show Report\n                        const panel = vscode.window.createWebviewPanel(\n                            'supreme2lReport',\n                            'Supreme Report',\n                            vscode.ViewColumn.One,\n                            { enableScripts: true }\n                        );\n                        panel.webview.html = generateReportHtml(results, panel.webview);\n\n                        vscode.window.showInformationMessage(`Scan complete. Found ${total} issues.`);\n                    } catch (e: any) {\n                        vscode.window.showErrorMessage(`Scan failed: ${e.message}`);\n                        sidebarProvider.setScanningState(false);\n                    }\n                });\n\n            } catch (e: any) {\n                sidebarProvider.setScanningState(false);\n                vscode.window.showErrorMessage(`Error starting scan: ${e.message}`);\n            }\n        }),\n\n        vscode.commands.registerCommand(CONFIG.COMMANDS.STOP_SCAN, () => {\n            PythonBridge.stopScan();\n            sidebarProvider.setScanningState(false);\n        }),\n\n        vscode.commands.registerCommand(CONFIG.COMMANDS.EXPORT_REPORT, async () => {\n            vscode.window.showInformationMessage(\"Export functionality coming soon!\");\n        }),\n\n        vscode.commands.registerCommand(CONFIG.COMMANDS.INSTALL_TOOLS, () => {\n            PythonBridge.installTools();\n        }),\n\n        vscode.commands.registerCommand('supreme2l.showHistoryReport', (item: ScanHistoryItem) => {\n            const panel = vscode.window.createWebviewPanel(\n                'supreme2lReport',\n                `Report: ${item.date.toLocaleString()}`,\n                vscode.ViewColumn.One,\n                { enableScripts: true }\n            );\n            panel.webview.html = generateReportHtml(item.results, panel.webview);\n        })\n    );\n\n    // Status Bar\n    const statusBarItem = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n    statusBarItem.text = \"$(shield) Supreme 2 Light\";\n    statusBarItem.command = CONFIG.COMMANDS.START_SCAN;\n    statusBarItem.show();\n    context.subscriptions.push(statusBarItem);\n}\n\nexport function deactivate() {\n    PythonBridge.stopScan();\n}\n"],"names":["_onDidChangeCodeLenses","vscode","EventEmitter","onDidChangeCodeLenses","this","event","issuesMap","Map","updateIssues","results","clear","forEach","file","uri","Uri","Target","toString","set","Issues","fire","provideCodeLenses","document","token","issues","get","length","lenses","lineMap","issue","line","StartLine","has","push","lineIssues","range","Range","count","cmd","title","some","i","Severity","Name","tooltip","map","Description","join","command","arguments","CodeLens","getGlobalVenvPath","path","os","homedir","getGlobalPythonPath","venvPath","isWin","process","platform","CONFIG","COMMANDS","START_SCAN","STOP_SCAN","EXPORT_REPORT","INSTALL_TOOLS","VIEWS","DASHBOARD","RESULTS","SETTINGS","PYTHON_PATH","EXCLUDE_PATHS","SEVERITY_FILTER","settingPath","workspace","getConfiguration","globalPython","fs","existsSync","pythonInterpreter","workspaceFolders","rootPath","fsPath","venvPaths","p","PythonBridge","setExtensionPath","extensionPath","checkInstallation","python","getPythonPath","Promise","resolve","checkProcess","cp","spawn","stdout","stderr","on","chunk","err","outputChannel","appendLine","message","code","trim","details","installTools","workspaceFolder","activeEditorPath","window","activeTextEditor","installTarget","dirname","picked","showOpenDialog","canSelectFiles","canSelectFolders","canSelectMany","openLabel","showWarningMessage","terminal","createTerminal","name","cwd","show","sendExecutable","executablePath","args","formattedArgs","arg","replace","quoteArg","sendText","pythonPath","wheelPath","systemPython","runScan","target","onProgress","childProcess","Error","tmpDir","mkdtempSync","tmpdir","scanCwd","stat","statSync","isDirectory","reject","data","output","append","includes","files","readdirSync","filter","f","endsWith","preferred","startsWith","sort","a","b","localeCompare","reverse","fallback","candidates","parsedReport","fileName","fullPath","raw","readFileSync","parsed","JSON","parse","Array","isArray","findings","parseResults","rmSync","recursive","force","e","console","error","stopScan","kill","json","targetRoot","resultMap","finding","cweValue","cwe_id","cwe","undefined","ID","rule_id","severity","toUpperCase","description","Type","tool","scanner","CodeSnippet","CWE","CWELink","cwe_link","createOutputChannel","escapeHtml","unsafe","webview","content","totalIssues","filePath","commandUri","encodeURIComponent","stringify","safeCode","codeHtml","cweHtml","Date","toLocaleString","constructor","_extensionUri","pendingMessages","isScanning","resolveWebviewView","webviewView","context","_token","_view","options","enableScripts","localResourceRoots","html","_getHtmlForWebview","onDidReceiveMessage","type","commands","executeCommand","sendInitialState","msg","postMessage","setScanningState","updateStats","total","critical","high","medium","low","rawScore","score","Math","round","setHistoryData","history","slice","svg","max","d","summary","points","htmlPath","htmlContent","ScanHistoryItem","TreeItem","label","date","collapsibleState","super","iconPath","ThemeIcon","_onDidChangeTreeData","onDidChangeTreeData","refresh","addScan","getStats","item","TreeItemCollapsibleState","None","unshift","getTreeItem","element","getChildren","getHistory","module","exports","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","log","sidebarProvider","SidebarProvider","extensionUri","treeProvider","TreeProvider","codeLensProvider","CodeLensProvider","subscriptions","registerWebviewViewProvider","registerTreeDataProvider","languages","registerCodeLensProvider","scheme","registerCommand","async","editorPath","showErrorMessage","withProgress","location","ProgressLocation","Notification","cancellable","progress","onCancellationRequested","report","reduce","acc","r","panel","createWebviewPanel","ViewColumn","One","generateReportHtml","showInformationMessage","statusBarItem","createStatusBarItem","StatusBarAlignment","Left","text"],"sourceRoot":""}